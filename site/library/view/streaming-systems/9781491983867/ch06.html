<!--[if IE]><![endif]--><!DOCTYPE html><!--[if IE 8]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"

    
        itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/"
data-offline-url="/"
data-url="/library/view/streaming-systems/9781491983867/ch06.html"
data-csrf-cookie="csrfsafari"
data-highlight-privacy=""


  data-user-id="3905629"
  data-user-uuid="f04af719-1c84-4fc3-9be3-1f1b4622ab99"
  data-username="safaribooksonline122"
  data-account-type="Trial"
  
  data-activated-trial-date="12/09/2018"


  data-archive="9781491983867"
  data-publishers="O&#39;Reilly Media, Inc."



  data-htmlfile-name="ch06.html"
  data-epub-title="Streaming Systems" data-debug=0 data-testing=0><![endif]--><!--[if gt IE 8]><!--><html class="js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom gr__safaribooksonline_com" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/streaming-systems/9781491983867/ch06.html" data-csrf-cookie="csrfsafari" data-highlight-privacy="" data-user-id="3905629" data-user-uuid="f04af719-1c84-4fc3-9be3-1f1b4622ab99" data-username="safaribooksonline122" data-account-type="Trial" data-activated-trial-date="12/09/2018" data-archive="9781491983867" data-publishers="O'Reilly Media, Inc." data-htmlfile-name="ch06.html" data-epub-title="Streaming Systems" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="Safari Books Online"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781491983867"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><link rel="apple-touch-icon" href="https://www.safaribooksonline.com/static/images/apple-touch-icon.0c29511d2d72.png"><link rel="shortcut icon" href="https://www.safaribooksonline.com/favicon.ico" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900,200italic,300italic,400italic,600italic,700italic,900italic" rel="stylesheet" type="text/css"><title>6. Streams and Tables - Streaming Systems</title><link rel="stylesheet" href="https://www.safaribooksonline.com/static/CACHE/css/5e586a47a3b7.css" type="text/css"><link rel="stylesheet" type="text/css" href="https://www.safaribooksonline.com/static/css/annotator.e3b0c44298fc.css"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"><style type="text/css" title="ibis-book">
    @charset "utf-8";#sbo-rt-content html,#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content span,#sbo-rt-content applet,#sbo-rt-content object,#sbo-rt-content iframe,#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p,#sbo-rt-content blockquote,#sbo-rt-content pre,#sbo-rt-content a,#sbo-rt-content abbr,#sbo-rt-content acronym,#sbo-rt-content address,#sbo-rt-content big,#sbo-rt-content cite,#sbo-rt-content code,#sbo-rt-content del,#sbo-rt-content dfn,#sbo-rt-content em,#sbo-rt-content img,#sbo-rt-content ins,#sbo-rt-content kbd,#sbo-rt-content q,#sbo-rt-content s,#sbo-rt-content samp,#sbo-rt-content small,#sbo-rt-content strike,#sbo-rt-content strong,#sbo-rt-content sub,#sbo-rt-content sup,#sbo-rt-content tt,#sbo-rt-content var,#sbo-rt-content b,#sbo-rt-content u,#sbo-rt-content i,#sbo-rt-content center,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content ol,#sbo-rt-content ul,#sbo-rt-content li,#sbo-rt-content fieldset,#sbo-rt-content form,#sbo-rt-content label,#sbo-rt-content legend,#sbo-rt-content table,#sbo-rt-content caption,#sbo-rt-content tdiv,#sbo-rt-content tfoot,#sbo-rt-content thead,#sbo-rt-content tr,#sbo-rt-content th,#sbo-rt-content td,#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content canvas,#sbo-rt-content details,#sbo-rt-content embed,#sbo-rt-content figure,#sbo-rt-content figcaption,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content output,#sbo-rt-content ruby,#sbo-rt-content section,#sbo-rt-content summary,#sbo-rt-content time,#sbo-rt-content mark,#sbo-rt-content audio,#sbo-rt-content video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content details,#sbo-rt-content figcaption,#sbo-rt-content figure,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content section{display:block}#sbo-rt-content div{line-height:1}#sbo-rt-content ol,#sbo-rt-content ul{list-style:none}#sbo-rt-content blockquote,#sbo-rt-content q{quotes:none}#sbo-rt-content blockquote:before,#sbo-rt-content blockquote:after,#sbo-rt-content q:before,#sbo-rt-content q:after{content:none}#sbo-rt-content table{border-collapse:collapse;border-spacing:0}@page{margin:5px !important}#sbo-rt-content p{margin:10px 0 0;line-height:125%;text-align:left}#sbo-rt-content p.byline{text-align:left;margin:-33px auto 35px;font-style:italic;font-weight:bold}#sbo-rt-content div.preface p+p.byline{margin:1em 0 0 !important}#sbo-rt-content div.preface p.byline+p.byline{margin:0 !important}#sbo-rt-content div.sect1>p.byline{margin:-.25em 0 1em}#sbo-rt-content div.sect1>p.byline+p.byline{margin-top:-1em}#sbo-rt-content em{font-style:italic;font-family:inherit}#sbo-rt-content em strong,#sbo-rt-content strong em{font-weight:bold;font-style:italic;font-family:inherit}#sbo-rt-content strong,#sbo-rt-content span.bold{font-weight:bold}#sbo-rt-content em.replaceable{font-style:italic}#sbo-rt-content strong.userinput{font-weight:bold;font-style:normal}#sbo-rt-content span.bolditalic{font-weight:bold;font-style:italic}#sbo-rt-content a.ulink,#sbo-rt-content a.xref,#sbo-rt-content a.email,#sbo-rt-content a.link,#sbo-rt-content a{text-decoration:none;color:#8e0012}#sbo-rt-content span.lineannotation{font-style:italic;color:#a62a2a;font-family:serif}#sbo-rt-content span.underline{text-decoration:underline}#sbo-rt-content span.strikethrough{text-decoration:line-through}#sbo-rt-content span.smallcaps{font-variant:small-caps}#sbo-rt-content span.cursor{background:#000;color:#fff}#sbo-rt-content span.smaller{font-size:75%}#sbo-rt-content .boxedtext,#sbo-rt-content .keycap{border-style:solid;border-width:1px;border-color:#000;padding:1px}#sbo-rt-content span.gray50{color:#7F7F7F;}#sbo-rt-content h1,#sbo-rt-content div.toc-title,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5{-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;font-weight:bold;text-align:left;page-break-after:avoid !important;font-family:sans-serif,"DejaVuSans"}#sbo-rt-content div.toc-title{font-size:1.5em;margin-top:20px !important;margin-bottom:30px !important}#sbo-rt-content section[data-type="sect1"] h1{font-size:1.3em;color:#8e0012;margin:40px 0 8px 0}#sbo-rt-content section[data-type="sect2"] h2{font-size:1.1em;margin:30px 0 8px 0 !important}#sbo-rt-content section[data-type="sect3"] h3{font-size:1em;color:#555;margin:20px 0 8px 0 !important}#sbo-rt-content section[data-type="sect4"] h4{font-size:1em;font-weight:normal;font-style:italic;margin:15px 0 6px 0 !important}#sbo-rt-content section[data-type="chapter"]>div>h1,#sbo-rt-content section[data-type="preface"]>div>h1,#sbo-rt-content section[data-type="appendix"]>div>h1,#sbo-rt-content section[data-type="glossary"]>div>h1,#sbo-rt-content section[data-type="bibliography"]>div>h1,#sbo-rt-content section[data-type="index"]>div>h1{font-size:2em;line-height:1;margin-bottom:50px;color:#000;padding-bottom:10px;border-bottom:1px solid #000}#sbo-rt-content span.label,#sbo-rt-content span.keep-together{font-size:inherit;font-weight:inherit}#sbo-rt-content div[data-type="part"] h1{font-size:2em;text-align:center;margin-top:0 !important;margin-bottom:50px;padding:50px 0 10px 0;border-bottom:1px solid #000}#sbo-rt-content img.width-ninety{width:90%}#sbo-rt-content img{max-width:95%;margin:0 auto;padding:0}#sbo-rt-content div.figure{background-color:transparent;text-align:center !important;margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content figure{margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content div.figure h6,#sbo-rt-content figure h6,#sbo-rt-content figure figcaption{font-size:.9rem !important;text-align:center;font-weight:normal !important;font-style:italic;font-family:serif !important;text-transform:none !important;letter-spacing:normal !important;color:#000 !important;padding-top:10px !important;page-break-before:avoid}#sbo-rt-content div.informalfigure{text-align:center !important;padding:5px 0 !important}#sbo-rt-content div.sidebar{margin:15px 0 10px 0 !important;border:1px solid #DCDCDC;background-color:#F7F7F7;padding:15px !important;page-break-inside:avoid}#sbo-rt-content aside[data-type="sidebar"]{margin:15px 0 10px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar-title,#sbo-rt-content aside[data-type="sidebar"] h5{font-weight:bold;font-size:1em;font-family:sans-serif;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar ol,#sbo-rt-content div.sidebar ul,#sbo-rt-content aside[data-type="sidebar"] ol,#sbo-rt-content aside[data-type="sidebar"] ul{margin-left:1.25em !important}#sbo-rt-content div.sidebar div.figure p.title,#sbo-rt-content aside[data-type="sidebar"] figcaption,#sbo-rt-content div.sidebar div.informalfigure div.caption{font-size:90%;text-align:center;font-weight:normal;font-style:italic;font-family:serif !important;color:#000;padding:5px !important;page-break-before:avoid;page-break-after:avoid}#sbo-rt-content div.sidebar div.tip,#sbo-rt-content div.sidebar div[data-type="tip"],#sbo-rt-content div.sidebar div.note,#sbo-rt-content div.sidebar div[data-type="note"],#sbo-rt-content div.sidebar div.warning,#sbo-rt-content div.sidebar div[data-type="warning"],#sbo-rt-content div.sidebar div[data-type="caution"],#sbo-rt-content div.sidebar div[data-type="important"]{margin:20px auto 20px auto !important;font-size:90%;width:85%}#sbo-rt-content aside[data-type="sidebar"] p.byline{font-size:90%;font-weight:bold;font-style:italic;text-align:center;text-indent:0;margin:5px auto 6px;page-break-after:avoid}#sbo-rt-content pre{white-space:pre-wrap;font-family:"Ubuntu Mono",monospace;margin:25px 0 25px 20px;font-size:85%;display:block;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content div.note pre.programlisting,#sbo-rt-content div.tip pre.programlisting,#sbo-rt-content div.warning pre.programlisting,#sbo-rt-content div.caution pre.programlisting,#sbo-rt-content div.important pre.programlisting{margin-bottom:0}#sbo-rt-content code{font-family:"Ubuntu Mono",monospace;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content code strong em,#sbo-rt-content code em strong,#sbo-rt-content pre em strong,#sbo-rt-content pre strong em,#sbo-rt-content strong code em code,#sbo-rt-content em code strong code,#sbo-rt-content span.bolditalic code{font-weight:bold;font-style:italic;font-family:"Ubuntu Mono BoldItal",monospace}#sbo-rt-content code em,#sbo-rt-content em code,#sbo-rt-content pre em,#sbo-rt-content em.replaceable{font-family:"Ubuntu Mono Ital",monospace;font-style:italic}#sbo-rt-content code strong,#sbo-rt-content strong code,#sbo-rt-content pre strong,#sbo-rt-content strong.userinput{font-family:"Ubuntu Mono Bold",monospace;font-weight:bold}#sbo-rt-content div[data-type="example"]{margin:10px 0 15px 0 !important}#sbo-rt-content div[data-type="example"] h1,#sbo-rt-content div[data-type="example"] h2,#sbo-rt-content div[data-type="example"] h3,#sbo-rt-content div[data-type="example"] h4,#sbo-rt-content div[data-type="example"] h5,#sbo-rt-content div[data-type="example"] h6{font-style:italic;font-weight:normal;text-align:left !important;text-transform:none !important;font-family:serif !important;margin:10px 0 5px 0 !important;border-bottom:1px solid #000}#sbo-rt-content li pre.example{padding:10px 0 !important}#sbo-rt-content div[data-type="example"] pre[data-type="programlisting"],#sbo-rt-content div[data-type="example"] pre[data-type="screen"]{margin:0}#sbo-rt-content section[data-type="titlepage"]>div>h1{font-size:2em;margin:50px 0 10px 0 !important;line-height:1;text-align:center}#sbo-rt-content section[data-type="titlepage"] h2,#sbo-rt-content section[data-type="titlepage"] p.subtitle,#sbo-rt-content section[data-type="titlepage"] p[data-type="subtitle"]{font-size:1.3em;font-weight:normal;text-align:center;margin-top:.5em;color:#555}#sbo-rt-content section[data-type="titlepage"]>div>h2[data-type="author"],#sbo-rt-content section[data-type="titlepage"] p.author{font-size:1.3em;font-family:serif !important;font-weight:bold;margin:50px 0 !important;text-align:center}#sbo-rt-content section[data-type="titlepage"] p.edition{text-align:center;text-transform:uppercase;margin-top:2em}#sbo-rt-content section[data-type="titlepage"]{text-align:center}#sbo-rt-content section[data-type="titlepage"]:after{content:url(css_assets/titlepage_footer_ebook.png);margin:0 auto;max-width:80%}#sbo-rt-content div.book div.titlepage div.publishername{margin-top:60%;margin-bottom:20px;text-align:center;font-size:1.25em}#sbo-rt-content div.book div.titlepage div.locations p{margin:0;text-align:center}#sbo-rt-content div.book div.titlepage div.locations p.cities{font-size:80%;text-align:center;margin-top:5px}#sbo-rt-content section.preface[title="Dedication"]>div.titlepage h2.title{text-align:center;text-transform:uppercase;font-size:1.5em;margin-top:50px;margin-bottom:50px}#sbo-rt-content ul.stafflist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.stafflist li{list-style-type:none;padding:5px 0}#sbo-rt-content ul.printings li{list-style-type:none}#sbo-rt-content section.preface[title="Dedication"] p{font-style:italic;text-align:center}#sbo-rt-content div.colophon h1.title{font-size:1.3em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon h2.subtitle{margin:0 !important;color:#000;font-family:serif !important;font-size:1em;font-weight:normal}#sbo-rt-content div.colophon div.author h3.author{font-size:1.1em;font-family:serif !important;margin:10px 0 0 !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h4,#sbo-rt-content div.colophon div.editor h3.editor{color:#000;font-size:.8em;margin:15px 0 0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h3.editor{font-size:.8em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.publisher{margin-top:10px}#sbo-rt-content div.colophon div.publisher p,#sbo-rt-content div.colophon div.publisher span.publishername{margin:0;font-size:.8em}#sbo-rt-content div.legalnotice p,#sbo-rt-content div.timestamp p{font-size:.8em}#sbo-rt-content div.timestamp p{margin-top:10px}#sbo-rt-content div.colophon[title="About the Author"] h1.title,#sbo-rt-content div.colophon[title="Colophon"] h1.title{font-size:1.5em;margin:0 !important;font-family:sans-serif !important}#sbo-rt-content section.chapter div.titlepage div.author{margin:10px 0 10px 0}#sbo-rt-content section.chapter div.titlepage div.author div.affiliation{font-style:italic}#sbo-rt-content div.attribution{margin:5px 0 0 50px !important}#sbo-rt-content h3.author span.orgname{display:none}#sbo-rt-content div.epigraph{margin:10px 0 10px 20px !important;page-break-inside:avoid;font-size:90%}#sbo-rt-content div.epigraph p{font-style:italic}#sbo-rt-content blockquote,#sbo-rt-content div.blockquote{margin:10px !important;page-break-inside:avoid;font-size:95%}#sbo-rt-content blockquote p,#sbo-rt-content div.blockquote p{font-style:italic;margin:.75em 0 0 !important}#sbo-rt-content blockquote div.attribution,#sbo-rt-content blockquote p[data-type="attribution"]{margin:5px 0 10px 30px !important;text-align:right;width:80%}#sbo-rt-content blockquote div.attribution p,#sbo-rt-content blockquote p[data-type="attribution"]{font-style:normal;margin-top:5px}#sbo-rt-content blockquote div.attribution p:before,#sbo-rt-content blockquote p[data-type="attribution"]:before{font-style:normal;content:"—";-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none}#sbo-rt-content p.right{text-align:right;margin:0}#sbo-rt-content div[data-type="footnotes"]{border-top:1px solid black;margin-top:1.5em}#sbo-rt-content sub,#sbo-rt-content sup{font-size:75%;line-height:0;position:relative}#sbo-rt-content sup{top:-.5em}#sbo-rt-content sub{bottom:-.25em}#sbo-rt-content div.refentry p.refname{font-size:1em;font-family:sans-serif,"DejaVuSans";font-weight:bold;margin-bottom:5px;overflow:auto;width:100%}#sbo-rt-content div.refentry{width:100%;display:block;margin-top:2em}#sbo-rt-content div.refsynopsisdiv{display:block;clear:both}#sbo-rt-content div.refentry header{page-break-inside:avoid !important;display:block;break-inside:avoid !important;padding-top:0;border-bottom:1px solid #000}#sbo-rt-content div.refsect1 h6{font-size:.9em;font-family:sans-serif,"DejaVuSans";font-weight:bold}#sbo-rt-content div.refsect1{margin-top:3em}#sbo-rt-content dt{padding-top:10px !important;padding-bottom:0 !important}#sbo-rt-content dd{margin-left:1.5em !important;margin-bottom:.25em}#sbo-rt-content dd ol,#sbo-rt-content dd ul{padding-left:1em}#sbo-rt-content dd li{margin-top:0;margin-bottom:0}#sbo-rt-content dd,#sbo-rt-content li{text-align:left}#sbo-rt-content ul,#sbo-rt-content ul>li,#sbo-rt-content ol ul,#sbo-rt-content ol ul>li,#sbo-rt-content ul ol ul,#sbo-rt-content ul ol ul>li{list-style-type:disc}#sbo-rt-content ul ul,#sbo-rt-content ul ul>li{list-style-type:square}#sbo-rt-content ul ul ul,#sbo-rt-content ul ul ul>li{list-style-type:circle}#sbo-rt-content ol,#sbo-rt-content ol>li,#sbo-rt-content ol ul ol,#sbo-rt-content ol ul ol>li,#sbo-rt-content ul ol,#sbo-rt-content ul ol>li{list-style-type:decimal}#sbo-rt-content ol ol,#sbo-rt-content ol ol>li{list-style-type:lower-alpha}#sbo-rt-content ol ol ol,#sbo-rt-content ol ol ol>li{list-style-type:lower-roman}#sbo-rt-content ol,#sbo-rt-content ul{list-style-position:outside;margin:15px 0 15px 1.25em;padding-left:2.25em}#sbo-rt-content ol li,#sbo-rt-content ul li{margin:.5em 0 .65em;line-height:125%}#sbo-rt-content div.orderedlistalpha{list-style-type:upper-alpha}#sbo-rt-content table.simplelist,#sbo-rt-content ul.simplelist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.simplelist li{list-style-type:none;padding:5px 0}#sbo-rt-content table.simplelist td{border:none}#sbo-rt-content table.simplelist tr{border-bottom:none}#sbo-rt-content table.simplelist tr:nth-of-type(even){background-color:transparent}#sbo-rt-content dl.calloutlist p:first-child{margin-top:-25px !important}#sbo-rt-content dl.calloutlist dd{padding-left:0;margin-top:-25px}#sbo-rt-content dl.calloutlist img,#sbo-rt-content a.co img{padding:0}#sbo-rt-content div.toc ol{margin-top:8px !important;margin-bottom:8px !important;margin-left:0 !important;padding-left:0 !important}#sbo-rt-content div.toc ol ol{margin-left:30px !important;padding-left:0 !important}#sbo-rt-content div.toc ol li{list-style-type:none}#sbo-rt-content div.toc a{color:#8e0012}#sbo-rt-content div.toc ol a{font-size:1em;font-weight:bold}#sbo-rt-content div.toc ol>li>ol a{font-weight:bold;font-size:1em}#sbo-rt-content div.toc ol>li>ol>li>ol a{text-decoration:none;font-weight:normal;font-size:1em}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"],#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{margin:30px !important;font-size:90%;padding:10px 8px 20px 8px !important;page-break-inside:avoid}#sbo-rt-content div.tip ol,#sbo-rt-content div.tip ul,#sbo-rt-content div[data-type="tip"] ol,#sbo-rt-content div[data-type="tip"] ul,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul,#sbo-rt-content div[data-type="note"] ol,#sbo-rt-content div[data-type="note"] ul,#sbo-rt-content div.warning ol,#sbo-rt-content div.warning ul,#sbo-rt-content div[data-type="warning"] ol,#sbo-rt-content div[data-type="warning"] ul,#sbo-rt-content div[data-type="caution"] ol,#sbo-rt-content div[data-type="caution"] ul,#sbo-rt-content div[data-type="important"] ol,#sbo-rt-content div[data-type="important"] ul{margin-left:1.5em !important}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"]{border:1px solid #BEBEBE;background-color:transparent}#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{border:1px solid #BC8F8F}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="note"] h1,#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1,#sbo-rt-content div[data-type="important"] h6{font-weight:bold;font-size:110%;font-family:sans-serif !important;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px !important}#sbo-rt-content div[data-type="tip"] figure h6,#sbo-rt-content div[data-type="note"] figure h6,#sbo-rt-content div[data-type="warning"] figure h6,#sbo-rt-content div[data-type="caution"] figure h6,#sbo-rt-content div[data-type="important"] figure h6{font-family:serif !important}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div[data-type="note"] h1{color:#737373}#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="important"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1{color:#C67171}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note,#sbo-rt-content div.safarienabled{background-color:transparent;margin:8px 0 0 !important;border:0 solid #BEBEBE;font-size:100%;padding:0 !important;page-break-inside:avoid}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note h3,#sbo-rt-content div.safarienabled h6{display:none}#sbo-rt-content div.table,#sbo-rt-content table{margin:15px 0 30px 0 !important;max-width:95%;border:none !important;background:none;display:table !important}#sbo-rt-content div.table,#sbo-rt-content div.informaltable,#sbo-rt-content table{page-break-inside:avoid}#sbo-rt-content tr,#sbo-rt-content tr td{border-bottom:1px solid #c3c3c3}#sbo-rt-content thead td,#sbo-rt-content thead th{border-bottom:#9d9d9d 1px solid !important;border-top:#9d9d9d 1px solid !important}#sbo-rt-content tr:nth-of-type(even){background-color:#f1f6fc}#sbo-rt-content thead{font-family:sans-serif;font-weight:bold}#sbo-rt-content td,#sbo-rt-content th{display:table-cell;padding:.3em;text-align:left;vertical-align:middle;font-size:80%}#sbo-rt-content div.informaltable table{margin:10px auto !important}#sbo-rt-content div.informaltable table tr{border-bottom:none}#sbo-rt-content div.informaltable table tr:nth-of-type(even){background-color:transparent}#sbo-rt-content div.informaltable td,#sbo-rt-content div.informaltable th{border:#9d9d9d 1px solid}#sbo-rt-content div.table-title,#sbo-rt-content table caption{font-weight:normal;font-style:italic;font-family:serif;font-size:1em;margin:10px 0 10px 0 !important;padding:0;page-break-after:avoid;text-align:left !important}#sbo-rt-content table code{font-size:smaller}#sbo-rt-content div.equation,#sbo-rt-content div[data-type="equation"]{margin:10px 0 15px 0 !important}#sbo-rt-content div.equation-title,#sbo-rt-content div[data-type="equation"] h5{font-style:italic;font-weight:normal;font-family:serif !important;font-size:90%;margin:20px 0 10px 0 !important;page-break-after:avoid}#sbo-rt-content div.equation-contents{margin-left:20px}#sbo-rt-content div[data-type="equation"] math{font-size:calc(.35em + 1vw)}#sbo-rt-content span.inlinemediaobject{height:.85em;display:inline-block;margin-bottom:.2em}#sbo-rt-content span.inlinemediaobject img{margin:0;height:.85em}#sbo-rt-content div.informalequation{margin:20px 0 20px 20px;width:75%}#sbo-rt-content div.informalequation img{width:75%}#sbo-rt-content div.index{text-indent:0}#sbo-rt-content div.index h3{padding:.25em;margin-top:1em !important;background-color:#F0F0F0}#sbo-rt-content div.index li{line-height:130%;list-style-type:none}#sbo-rt-content div.index a.indexterm{color:#8e0012 !important}#sbo-rt-content div.index ul{margin-left:0 !important;padding-left:0 !important}#sbo-rt-content div.index ul ul{margin-left:1em !important;margin-top:0 !important}#sbo-rt-content code.boolean,#sbo-rt-content .navy{color:rgb(0,0,128);}#sbo-rt-content code.character,#sbo-rt-content .olive{color:rgb(128,128,0);}#sbo-rt-content code.comment,#sbo-rt-content .blue{color:rgb(0,0,255);}#sbo-rt-content code.conditional,#sbo-rt-content .limegreen{color:rgb(50,205,50);}#sbo-rt-content code.constant,#sbo-rt-content .darkorange{color:rgb(255,140,0);}#sbo-rt-content code.debug,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.define,#sbo-rt-content .darkgoldenrod,#sbo-rt-content .gold{color:rgb(184,134,11);}#sbo-rt-content code.delimiter,#sbo-rt-content .dimgray{color:rgb(105,105,105);}#sbo-rt-content code.error,#sbo-rt-content .red{color:rgb(255,0,0);}#sbo-rt-content code.exception,#sbo-rt-content .salmon{color:rgb(250,128,11);}#sbo-rt-content code.float,#sbo-rt-content .steelblue{color:rgb(70,130,180);}#sbo-rt-content pre code.function,#sbo-rt-content .green{color:rgb(0,128,0);}#sbo-rt-content code.identifier,#sbo-rt-content .royalblue{color:rgb(65,105,225);}#sbo-rt-content code.ignore,#sbo-rt-content .gray{color:rgb(128,128,128);}#sbo-rt-content code.include,#sbo-rt-content .purple{color:rgb(128,0,128);}#sbo-rt-content code.keyword,#sbo-rt-content .sienna{color:rgb(160,82,45);}#sbo-rt-content code.label,#sbo-rt-content .deeppink{color:rgb(255,20,147);}#sbo-rt-content code.macro,#sbo-rt-content .orangered{color:rgb(255,69,0);}#sbo-rt-content code.number,#sbo-rt-content .brown{color:rgb(165,42,42);}#sbo-rt-content code.operator,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.preCondit,#sbo-rt-content .teal{color:rgb(0,128,128);}#sbo-rt-content code.preProc,#sbo-rt-content .fuschia{color:rgb(255,0,255);}#sbo-rt-content code.repeat,#sbo-rt-content .indigo{color:rgb(75,0,130);}#sbo-rt-content code.special,#sbo-rt-content .saddlebrown{color:rgb(139,69,19);}#sbo-rt-content code.specialchar,#sbo-rt-content .magenta{color:rgb(255,0,255);}#sbo-rt-content code.specialcomment,#sbo-rt-content .seagreen{color:rgb(46,139,87);}#sbo-rt-content code.statement,#sbo-rt-content .forestgreen{color:rgb(34,139,34);}#sbo-rt-content code.storageclass,#sbo-rt-content .plum{color:rgb(221,160,221);}#sbo-rt-content code.string,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.structure,#sbo-rt-content .chocolate{color:rgb(210,106,30);}#sbo-rt-content code.tag,#sbo-rt-content .darkcyan{color:rgb(0,139,139);}#sbo-rt-content code.todo,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.type,#sbo-rt-content .mediumslateblue{color:rgb(123,104,238);}#sbo-rt-content code.typedef,#sbo-rt-content .darkgreen{color:rgb(0,100,0);}#sbo-rt-content code.underlined{text-decoration:underline;}#sbo-rt-content pre code.hll{background-color:#ffc}#sbo-rt-content pre code.c{color:#09F;font-style:italic}#sbo-rt-content pre code.err{color:#A00}#sbo-rt-content pre code.k{color:#069;font-weight:bold}#sbo-rt-content pre code.o{color:#555}#sbo-rt-content pre code.cm{color:#35586C;font-style:italic}#sbo-rt-content pre code.cp{color:#099}#sbo-rt-content pre code.c1{color:#35586C;font-style:italic}#sbo-rt-content pre code.cs{color:#35586C;font-weight:bold;font-style:italic}#sbo-rt-content pre code.gd{background-color:#FCC}#sbo-rt-content pre code.ge{font-style:italic}#sbo-rt-content pre code.gr{color:#F00}#sbo-rt-content pre code.gh{color:#030;font-weight:bold}#sbo-rt-content pre code.gi{background-color:#CFC}#sbo-rt-content pre code.go{color:#000}#sbo-rt-content pre code.gp{color:#009;font-weight:bold}#sbo-rt-content pre code.gs{font-weight:bold}#sbo-rt-content pre code.gu{color:#030;font-weight:bold}#sbo-rt-content pre code.gt{color:#9C6}#sbo-rt-content pre code.kc{color:#069;font-weight:bold}#sbo-rt-content pre code.kd{color:#069;font-weight:bold}#sbo-rt-content pre code.kn{color:#069;font-weight:bold}#sbo-rt-content pre code.kp{color:#069}#sbo-rt-content pre code.kr{color:#069;font-weight:bold}#sbo-rt-content pre code.kt{color:#078;font-weight:bold}#sbo-rt-content pre code.m{color:#F60}#sbo-rt-content pre code.s{color:#C30}#sbo-rt-content pre code.na{color:#309}#sbo-rt-content pre code.nb{color:#366}#sbo-rt-content pre code.nc{color:#0A8;font-weight:bold}#sbo-rt-content pre code.no{color:#360}#sbo-rt-content pre code.nd{color:#99F}#sbo-rt-content pre code.ni{color:#999;font-weight:bold}#sbo-rt-content pre code.ne{color:#C00;font-weight:bold}#sbo-rt-content pre code.nf{color:#C0F}#sbo-rt-content pre code.nl{color:#99F}#sbo-rt-content pre code.nn{color:#0CF;font-weight:bold}#sbo-rt-content pre code.nt{color:#309;font-weight:bold}#sbo-rt-content pre code.nv{color:#033}#sbo-rt-content pre code.ow{color:#000;font-weight:bold}#sbo-rt-content pre code.w{color:#bbb}#sbo-rt-content pre code.mf{color:#F60}#sbo-rt-content pre code.mh{color:#F60}#sbo-rt-content pre code.mi{color:#F60}#sbo-rt-content pre code.mo{color:#F60}#sbo-rt-content pre code.sb{color:#C30}#sbo-rt-content pre code.sc{color:#C30}#sbo-rt-content pre code.sd{color:#C30;font-style:italic}#sbo-rt-content pre code.s2{color:#C30}#sbo-rt-content pre code.se{color:#C30;font-weight:bold}#sbo-rt-content pre code.sh{color:#C30}#sbo-rt-content pre code.si{color:#A00}#sbo-rt-content pre code.sx{color:#C30}#sbo-rt-content pre code.sr{color:#3AA}#sbo-rt-content pre code.s1{color:#C30}#sbo-rt-content pre code.ss{color:#A60}#sbo-rt-content pre code.bp{color:#366}#sbo-rt-content pre code.vc{color:#033}#sbo-rt-content pre code.vg{color:#033}#sbo-rt-content pre code.vi{color:#033}#sbo-rt-content pre code.il{color:#F60}#sbo-rt-content pre code.g{color:#050}#sbo-rt-content pre code.l{color:#C60}#sbo-rt-content pre code.l{color:#F90}#sbo-rt-content pre code.n{color:#008}#sbo-rt-content pre code.nx{color:#008}#sbo-rt-content pre code.py{color:#96F}#sbo-rt-content pre code.p{color:#000}#sbo-rt-content pre code.x{color:#F06}#sbo-rt-content div.blockquote_sampler_toc{width:95%;margin:5px 5px 5px 10px !important}#sbo-rt-content div{font-family:serif;text-align:left}#sbo-rt-content .gray-background,#sbo-rt-content .reverse-video{background:#2E2E2E;color:#FFF}#sbo-rt-content .light-gray-background{background:#A0A0A0}#sbo-rt-content .preserve-whitespace{white-space:pre-wrap}#sbo-rt-content span.gray{color:#4C4C4C}#sbo-rt-content .what_lt{color:#c90;}#sbo-rt-content .where_lt{color:#26c}#sbo-rt-content .when_lt{color:#6a5;}#sbo-rt-content .how_lt{color:#c00}#sbo-rt-content .what_dk{color:#ffd040}#sbo-rt-content .where_dk{color:#6af}#sbo-rt-content .when_dk{color:#8ac86f}#sbo-rt-content .how_dk{color:#d77}#sbo-rt-content .grey_bg{background-color:#ff0}#sbo-rt-content .yellow_bg{background-color:#ff0}#sbo-rt-content .green_bg{background-color:#00FF7F}#sbo-rt-content .red_bg{background-color:#FFA07A}#sbo-rt-content .blue_bg{background-color:#87CEEB}#sbo-rt-content .code_blue{color:#00f}#sbo-rt-content .code_grey{color:#777}#sbo-rt-content .code_orange{color:#d83}#sbo-rt-content .code_purple{color:#87c}#sbo-rt-content .code_lightgrey{color:#C0C0C0}#sbo-rt-content .strikethrough{text-decoration:line-through}#sbo-rt-content .table_white{color:white}#sbo-rt-content .table_black{color:black}#sbo-rt-content .table_red{color:#d77}#sbo-rt-content .table_green{color:#8ac86f}#sbo-rt-content .table_blue{color:#00f}#sbo-rt-content .table_mediumgrey{background-color:#404040}#sbo-rt-content .table_lightgrey{background-color:#606060}#sbo-rt-content .table_darkgrey{background-color:#202020}
    </style><link rel="canonical" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html"><meta name="description" content=" Chapter 6. Streams and Tables You have reached the part of the book where we talk about streams and tables. If you recall, back in Chapter&nbsp;1, we briefly discussed ... "><meta property="og:title" content="6. Streams and Tables"><meta itemprop="isPartOf" content="/library/view/streaming-systems/9781491983867/"><meta itemprop="name" content="6. Streams and Tables"><meta property="og:url" itemprop="url" content="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/ch06.html"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://www.safaribooksonline.com/library/cover/9781491983867/"><meta property="og:description" itemprop="description" content=" Chapter 6. Streams and Tables You have reached the part of the book where we talk about streams and tables. If you recall, back in Chapter&nbsp;1, we briefly discussed ... "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="O'Reilly Media, Inc."><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781491983874"><meta property="og:book:author" itemprop="author" content="Reuven Lax"><meta property="og:book:author" itemprop="author" content="Slava Chernyak"><meta property="og:book:author" itemprop="author" content="Tyler Akidau"><meta property="og:book:tag" itemprop="about" content="Databases"><meta property="og:book:tag" itemprop="about" content="Engineering"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@safari"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: <%= font_size %> !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: <%= font_family %> !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: <%= column_width %>% !important; margin: 0 auto !important; }"></style><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style></head>


<body class="reading sidenav nav-collapsed  scalefonts subscribe-panel library" data-gr-c-s-loaded="true">

    
  
  
  



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        





<a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#container" class="skip">Skip to content</a><header class="topbar t-topbar" style="display:None"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li class="t-logo"><a href="https://www.safaribooksonline.com/home/" class="l0 None safari-home nav-icn js-keyboard-nav-home"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>Safari Home Icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M4 9.9L4 9.9 4 18 16 18 16 9.9 10 4 4 9.9ZM2.6 8.1L2.6 8.1 8.7 1.9 10 0.5 11.3 1.9 17.4 8.1 18 8.7 18 9.5 18 18.1 18 20 16.1 20 3.9 20 2 20 2 18.1 2 9.5 2 8.7 2.6 8.1Z"></path><rect x="10" y="12" width="3" height="7"></rect><rect transform="translate(18.121320, 10.121320) rotate(-315.000000) translate(-18.121320, -10.121320) " x="16.1" y="9.1" width="4" height="2"></rect><rect transform="translate(2.121320, 10.121320) scale(-1, 1) rotate(-315.000000) translate(-2.121320, -10.121320) " x="0.1" y="9.1" width="4" height="2"></rect></g></svg><span>Safari Home</span></a></li><li><a href="https://www.safaribooksonline.com/r/" class="t-recommendations-nav l0 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recommendations icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M50 25C50 18.2 44.9 12.5 38.3 11.7 37.5 5.1 31.8 0 25 0 18.2 0 12.5 5.1 11.7 11.7 5.1 12.5 0 18.2 0 25 0 31.8 5.1 37.5 11.7 38.3 12.5 44.9 18.2 50 25 50 31.8 50 37.5 44.9 38.3 38.3 44.9 37.5 50 31.8 50 25ZM25 3.1C29.7 3.1 33.6 6.9 34.4 11.8 30.4 12.4 26.9 15.1 25 18.8 23.1 15.1 19.6 12.4 15.6 11.8 16.4 6.9 20.3 3.1 25 3.1ZM34.4 15.6C33.6 19.3 30.7 22.2 27.1 22.9 27.8 19.2 30.7 16.3 34.4 15.6ZM22.9 22.9C19.2 22.2 16.3 19.3 15.6 15.6 19.3 16.3 22.2 19.2 22.9 22.9ZM3.1 25C3.1 20.3 6.9 16.4 11.8 15.6 12.4 19.6 15.1 23.1 18.8 25 15.1 26.9 12.4 30.4 11.8 34.4 6.9 33.6 3.1 29.7 3.1 25ZM22.9 27.1C22.2 30.7 19.3 33.6 15.6 34.4 16.3 30.7 19.2 27.8 22.9 27.1ZM25 46.9C20.3 46.9 16.4 43.1 15.6 38.2 19.6 37.6 23.1 34.9 25 31.3 26.9 34.9 30.4 37.6 34.4 38.2 33.6 43.1 29.7 46.9 25 46.9ZM27.1 27.1C30.7 27.8 33.6 30.7 34.4 34.4 30.7 33.6 27.8 30.7 27.1 27.1ZM38.2 34.4C37.6 30.4 34.9 26.9 31.3 25 34.9 23.1 37.6 19.6 38.2 15.6 43.1 16.4 46.9 20.3 46.9 25 46.9 29.7 43.1 33.6 38.2 34.4Z"></path></g></svg><span>Recommended</span></a></li><li><a href="https://www.safaribooksonline.com/playlists/" class="t-queue-nav l0 nav-icn None"><!--?xml version="1.0" encoding="UTF-8"?--><svg width="21px" height="17px" viewBox="0 0 21 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --><title>icon_Playlist_sml</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="icon_Playlist_sml" fill-rule="nonzero" fill="#000000"><g id="playlist-icon"><g id="Group-6"><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle></g><g id="Group-5" transform="translate(0.000000, 7.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g><g id="Group-5-Copy" transform="translate(0.000000, 14.000000)"><circle id="Oval" cx="1.5" cy="1.5" r="1.5"></circle><rect id="Rectangle-path" x="5" y="0" width="16" height="3" rx="0.5"></rect></g></g></g></g></svg><span>
               Playlists
            </span></a></li><li class="search"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li><a href="https://www.safaribooksonline.com/history/" class="t-recent-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>recent items icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 0C11.2 0 0 11.2 0 25 0 38.8 11.2 50 25 50 38.8 50 50 38.8 50 25 50 11.2 38.8 0 25 0ZM6.3 25C6.3 14.6 14.6 6.3 25 6.3 35.4 6.3 43.8 14.6 43.8 25 43.8 35.4 35.4 43.8 25 43.8 14.6 43.8 6.3 35.4 6.3 25ZM31.8 31.5C32.5 30.5 32.4 29.2 31.6 28.3L27.1 23.8 27.1 12.8C27.1 11.5 26.2 10.4 25 10.4 23.9 10.4 22.9 11.5 22.9 12.8L22.9 25.7 28.8 31.7C29.2 32.1 29.7 32.3 30.2 32.3 30.8 32.3 31.3 32 31.8 31.5Z"></path></g></svg><span>History</span></a></li><li><a href="https://www.safaribooksonline.com/topics" class="t-topics-link l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 55" width="20" height="20" version="1.1" fill="#4A3C31"><desc>topics icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 55L50 41.262 50 13.762 25 0 0 13.762 0 41.262 25 55ZM8.333 37.032L8.333 17.968 25 8.462 41.667 17.968 41.667 37.032 25 46.538 8.333 37.032Z"></path></g></svg><span>Topics</span></a></li><li><a href="https://www.safaribooksonline.com/tutorials/" class="l1 nav-icn t-tutorials-nav js-toggle-menu-item None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>tutorials icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M15.8 18.2C15.8 18.2 15.9 18.2 16 18.2 16.1 18.2 16.2 18.2 16.4 18.2 16.5 18.2 16.7 18.1 16.9 18 17 17.9 17.1 17.8 17.2 17.7 17.3 17.6 17.4 17.5 17.4 17.4 17.5 17.2 17.6 16.9 17.6 16.7 17.6 16.6 17.6 16.5 17.6 16.4 17.5 16.2 17.5 16.1 17.4 15.9 17.3 15.8 17.2 15.6 17 15.5 16.8 15.3 16.6 15.3 16.4 15.2 16.2 15.2 16 15.2 15.8 15.2 15.7 15.2 15.5 15.3 15.3 15.4 15.2 15.4 15.1 15.5 15 15.7 14.9 15.8 14.8 15.9 14.7 16 14.7 16.1 14.6 16.3 14.6 16.4 14.6 16.5 14.6 16.6 14.6 16.6 14.6 16.7 14.6 16.9 14.6 17 14.6 17.1 14.7 17.3 14.7 17.4 14.8 17.6 15 17.7 15.1 17.9 15.2 18 15.3 18 15.5 18.1 15.5 18.1 15.6 18.2 15.7 18.2 15.7 18.2 15.7 18.2 15.8 18.2L15.8 18.2ZM9.4 11.5C9.5 11.5 9.5 11.5 9.6 11.5 9.7 11.5 9.9 11.5 10 11.5 10.2 11.5 10.3 11.4 10.5 11.3 10.6 11.2 10.8 11.1 10.9 11 10.9 10.9 11 10.8 11.1 10.7 11.2 10.5 11.2 10.2 11.2 10 11.2 9.9 11.2 9.8 11.2 9.7 11.2 9.5 11.1 9.4 11 9.2 10.9 9.1 10.8 8.9 10.6 8.8 10.5 8.7 10.3 8.6 10 8.5 9.9 8.5 9.7 8.5 9.5 8.5 9.3 8.5 9.1 8.6 9 8.7 8.8 8.7 8.7 8.8 8.6 9 8.5 9.1 8.4 9.2 8.4 9.3 8.2 9.5 8.2 9.8 8.2 10 8.2 10.1 8.2 10.2 8.2 10.3 8.2 10.5 8.3 10.6 8.4 10.7 8.5 10.9 8.6 11.1 8.7 11.2 8.9 11.3 9 11.4 9.1 11.4 9.2 11.4 9.3 11.5 9.3 11.5 9.3 11.5 9.4 11.5 9.4 11.5L9.4 11.5ZM3 4.8C3.1 4.8 3.1 4.8 3.2 4.8 3.4 4.8 3.5 4.8 3.7 4.8 3.8 4.8 4 4.7 4.1 4.6 4.3 4.5 4.4 4.4 4.5 4.3 4.6 4.2 4.6 4.1 4.7 4 4.8 3.8 4.8 3.5 4.8 3.3 4.8 3.1 4.8 3 4.8 2.9 4.7 2.8 4.7 2.6 4.6 2.5 4.5 2.3 4.4 2.2 4.2 2.1 4 1.9 3.8 1.9 3.6 1.8 3.5 1.8 3.3 1.8 3.1 1.8 2.9 1.8 2.7 1.9 2.6 2 2.4 2.1 2.3 2.2 2.2 2.3 2.1 2.4 2 2.5 2 2.6 1.8 2.8 1.8 3 1.8 3.3 1.8 3.4 1.8 3.5 1.8 3.6 1.8 3.8 1.9 3.9 2 4 2.1 4.2 2.2 4.4 2.4 4.5 2.5 4.6 2.6 4.7 2.7 4.7 2.8 4.7 2.9 4.8 2.9 4.8 3 4.8 3 4.8 3 4.8L3 4.8ZM13.1 15.2C13.2 15.1 13.2 15.1 13.2 15.1 13.3 14.9 13.4 14.7 13.6 14.5 13.8 14.2 14.1 14 14.4 13.8 14.7 13.6 15.1 13.5 15.5 13.4 15.9 13.4 16.3 13.4 16.7 13.5 17.2 13.5 17.6 13.7 17.9 13.9 18.2 14.1 18.5 14.4 18.7 14.7 18.9 15 19.1 15.3 19.2 15.6 19.3 15.9 19.4 16.1 19.4 16.4 19.4 17 19.3 17.5 19.1 18.1 19 18.3 18.9 18.5 18.7 18.7 18.5 19 18.3 19.2 18 19.4 17.7 19.6 17.3 19.8 16.9 19.9 16.6 20 16.3 20 16 20 15.8 20 15.6 20 15.4 19.9 15.4 19.9 15.4 19.9 15.4 19.9 15.2 19.9 15 19.8 14.9 19.8 14.8 19.7 14.7 19.7 14.6 19.7 14.4 19.6 14.3 19.5 14.1 19.3 13.7 19.1 13.4 18.7 13.2 18.4 13.1 18.1 12.9 17.8 12.9 17.5 12.8 17.3 12.8 17.1 12.8 16.9L3.5 14.9C3.3 14.9 3.1 14.8 3 14.8 2.7 14.7 2.4 14.5 2.1 14.3 1.7 14 1.4 13.7 1.2 13.3 1 13 0.9 12.6 0.8 12.3 0.7 12 0.7 11.7 0.7 11.4 0.7 11 0.8 10.5 1 10.1 1.1 9.8 1.3 9.5 1.6 9.2 1.8 8.9 2.1 8.7 2.4 8.5 2.8 8.3 3.2 8.1 3.6 8.1 3.9 8 4.2 8 4.5 8 4.6 8 4.8 8 4.9 8.1L6.8 8.5C6.8 8.4 6.8 8.4 6.8 8.4 6.9 8.2 7.1 8 7.2 7.8 7.5 7.5 7.7 7.3 8 7.1 8.4 6.9 8.7 6.8 9.1 6.7 9.5 6.7 10 6.7 10.4 6.8 10.8 6.8 11.2 7 11.5 7.2 11.8 7.5 12.1 7.7 12.4 8 12.6 8.3 12.7 8.6 12.8 8.9 12.9 9.2 13 9.4 13 9.7 13 9.7 13 9.8 13 9.8 13.6 9.9 14.2 10.1 14.9 10.2 15 10.2 15 10.2 15.1 10.2 15.3 10.2 15.4 10.2 15.6 10.2 15.8 10.1 16 10 16.2 9.9 16.4 9.8 16.5 9.6 16.6 9.5 16.8 9.2 16.9 8.8 16.9 8.5 16.9 8.3 16.9 8.2 16.8 8 16.8 7.8 16.7 7.7 16.6 7.5 16.5 7.3 16.3 7.2 16.2 7.1 16 7 15.9 6.9 15.8 6.9 15.7 6.9 15.6 6.8 15.5 6.8L6.2 4.8C6.2 5 6 5.2 5.9 5.3 5.7 5.6 5.5 5.8 5.3 6 4.9 6.2 4.5 6.4 4.1 6.5 3.8 6.6 3.5 6.6 3.2 6.6 3 6.6 2.8 6.6 2.7 6.6 2.6 6.6 2.6 6.5 2.6 6.5 2.5 6.5 2.3 6.5 2.1 6.4 1.8 6.3 1.6 6.1 1.3 6 1 5.7 0.7 5.4 0.5 5 0.3 4.7 0.2 4.4 0.1 4.1 0 3.8 0 3.6 0 3.3 0 2.8 0.1 2.2 0.4 1.7 0.5 1.5 0.7 1.3 0.8 1.1 1.1 0.8 1.3 0.6 1.6 0.5 2 0.3 2.3 0.1 2.7 0.1 3.1 0 3.6 0 4 0.1 4.4 0.2 4.8 0.3 5.1 0.5 5.5 0.8 5.7 1 6 1.3 6.2 1.6 6.3 1.9 6.4 2.3 6.5 2.5 6.6 2.7 6.6 3 6.6 3 6.6 3.1 6.6 3.1 9.7 3.8 12.8 4.4 15.9 5.1 16.1 5.1 16.2 5.2 16.4 5.2 16.7 5.3 16.9 5.5 17.2 5.6 17.5 5.9 17.8 6.2 18.1 6.5 18.3 6.8 18.4 7.2 18.6 7.5 18.6 7.9 18.7 8.2 18.7 8.6 18.7 9 18.6 9.4 18.4 9.8 18.3 10.1 18.2 10.3 18 10.6 17.8 10.9 17.5 11.1 17.3 11.3 16.9 11.6 16.5 11.8 16 11.9 15.7 12 15.3 12 15 12 14.8 12 14.7 12 14.5 11.9 13.9 11.8 13.3 11.7 12.6 11.5 12.5 11.7 12.4 11.9 12.3 12 12.1 12.3 11.9 12.5 11.7 12.7 11.3 12.9 10.9 13.1 10.5 13.2 10.2 13.3 9.9 13.3 9.6 13.3 9.4 13.3 9.2 13.3 9 13.2 9 13.2 9 13.2 9 13.2 8.8 13.2 8.7 13.2 8.5 13.1 8.2 13 8 12.8 7.7 12.6 7.4 12.4 7.1 12 6.8 11.7 6.7 11.4 6.6 11.1 6.5 10.8 6.4 10.6 6.4 10.4 6.4 10.2 5.8 10.1 5.2 9.9 4.5 9.8 4.4 9.8 4.4 9.8 4.3 9.8 4.1 9.8 4 9.8 3.8 9.8 3.6 9.9 3.4 10 3.2 10.1 3 10.2 2.9 10.4 2.8 10.5 2.6 10.8 2.5 11.1 2.5 11.5 2.5 11.6 2.5 11.8 2.6 12 2.6 12.1 2.7 12.3 2.8 12.5 2.9 12.6 3.1 12.8 3.2 12.9 3.3 13 3.5 13.1 3.6 13.1 3.7 13.1 3.8 13.2 3.9 13.2L13.1 15.2 13.1 15.2Z"></path></g></svg><span>Tutorials</span></a></li><li class="nav-offers flyout-parent"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" class="l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>offers icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M35.9 20.6L27 15.5C26.1 15 24.7 15 23.7 15.5L14.9 20.6C13.9 21.1 13.2 22.4 13.2 23.4L13.2 41.4C13.2 42.4 13.9 43.7 14.9 44.2L23.3 49C24.2 49.5 25.6 49.5 26.6 49L35.9 43.6C36.8 43.1 37.6 41.8 37.6 40.8L37.6 23.4C37.6 22.4 36.8 21.1 35.9 20.6L35.9 20.6ZM40 8.2C39.1 7.6 37.6 7.6 36.7 8.2L30.2 11.9C29.3 12.4 29.3 13.2 30.2 13.8L39.1 18.8C40 19.4 40.7 20.6 40.7 21.7L40.7 39C40.7 40.1 41.4 40.5 42.4 40L48.2 36.6C49.1 36.1 49.8 34.9 49.8 33.8L49.8 15.6C49.8 14.6 49.1 13.3 48.2 12.8L40 8.2 40 8.2ZM27 10.1L33.6 6.4C34.5 5.9 34.5 5 33.6 4.5L26.6 0.5C25.6 0 24.2 0 23.3 0.5L16.7 4.2C15.8 4.7 15.8 5.6 16.7 6.1L23.7 10.1C24.7 10.6 26.1 10.6 27 10.1ZM10.1 21.7C10.1 20.6 10.8 19.4 11.7 18.8L20.6 13.8C21.5 13.2 21.5 12.4 20.6 11.9L13.6 7.9C12.7 7.4 11.2 7.4 10.3 7.9L1.6 12.8C0.7 13.3 0 14.6 0 15.6L0 33.8C0 34.9 0.7 36.1 1.6 36.6L8.4 40.5C9.3 41 10.1 40.6 10.1 39.6L10.1 21.7 10.1 21.7Z"></path></g></svg><span>Offers &amp; Deals</span></a><ul class="flyout"><li><a href="https://get.oreilly.com/email-signup.html" target="_blank" class="l2 nav-icn"><span>Newsletters</span></a></li></ul></li><li class="nav-highlights"><a href="https://www.safaribooksonline.com/u/f04af719-1c84-4fc3-9be3-1f1b4622ab99/" class="t-highlights-nav l1 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 35" width="20" height="20" version="1.1" fill="#4A3C31"><desc>highlights icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M13.325 18.071L8.036 18.071C8.036 11.335 12.36 7.146 22.5 5.594L22.5 0C6.37 1.113 0 10.632 0 22.113 0 29.406 3.477 35 10.403 35 15.545 35 19.578 31.485 19.578 26.184 19.578 21.556 17.211 18.891 13.325 18.071L13.325 18.071ZM40.825 18.071L35.565 18.071C35.565 11.335 39.86 7.146 50 5.594L50 0C33.899 1.113 27.5 10.632 27.5 22.113 27.5 29.406 30.977 35 37.932 35 43.045 35 47.078 31.485 47.078 26.184 47.078 21.556 44.74 18.891 40.825 18.071L40.825 18.071Z"></path></g></svg><span>Highlights</span></a></li><li><a href="https://www.safaribooksonline.com/u/preferences/" class="t-settings-nav l1 js-settings nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l1 no-icon">Support</a></li><li><a href="https://www.safaribooksonline.com/accounts/logout/" class="l1 no-icon">Sign Out</a></li></ul><ul class="profile"><li><a href="https://www.safaribooksonline.com/u/preferences/" class="l2 nav-icn None"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a><span class="l2 t-nag-notification" id="nav-nag"><strong class="trial-green">10</strong> days left in your trial.
  
  

  
    
      

<a class="" href="https://www.safaribooksonline.com/subscribe/">Subscribe</a>.


    
  

  

</span></li><li><a href="https://www.oreilly.com/online-learning/support/" class="l2">Support</a></li><li><a href="https://www.safaribooksonline.com/accounts/logout/" class="l2">Sign Out</a></li></ul></div></li></ul></nav></header>


      </div>
      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Streaming Systems
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" title="Search in archive" class="js-search-controls search-controls"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781491983867/chapter/ch06.html"><div class="js-collections-dropdown collections-dropdown menu-bit-cards"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="https://www.safaribooksonline.com/static/images/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" class="trigger" data-push-state="false" title="Share" aria-label="Share"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/ch06.html&amp;text=Streaming%20Systems&amp;via=safari"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/ch06.html"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/ch06.html"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%206.%20Streams%20and%20Tables&amp;body=https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/ch06.html%0D%0Afrom%20Streaming%20Systems%0D%0A"><span>Email</span></a></li></ul></li>
      </ul>
    </div>

    <section role="document">
        
        



 <!--[if lt IE 9]>
  
<![endif]-->



  


        
	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/part02.html" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">II. Streams and Tables</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch07.html" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">7. The Practicalities of Persistent State</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content" style="transform: none;"><div class="annotator-wrapper"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 6. Streams and Tables"><div class="chapter" id="streams_and_tables">
<h1><span class="label">Chapter 6. </span>Streams and Tables</h1>

<p>You have reached the part of the book where we talk about streams<a contenteditable="false" data-primary="tables and streams" data-startref="ix_tblstrm" data-type="indexterm" id="idm140176513543312"></a> and tables.<a contenteditable="false" data-primary="streams" data-secondary="and tables" data-type="indexterm" id="ix_strmtbl"></a> If you recall, back in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch01.html#streaming_one_oh_one">Chapter&nbsp;1</a>, we briefly discussed two important but orthogonal <a contenteditable="false" data-primary="cardinality" data-secondary="of datasets" data-type="indexterm" id="idm140176513840128"></a>dimensions of data: <em>cardinality</em> and <em>constitution</em>.<a contenteditable="false" data-primary="constitution of a dataset" data-type="indexterm" id="idm140176513837728"></a> Until now, we’ve focused strictly on the cardinality aspects (bounded versus unbounded) and otherwise ignored the constitution aspects (stream versus table). This has allowed us to learn about the challenges brought to the table by the introduction of unbounded datasets, without worrying too much about the lower-level details that really drive the way things work. We’re now going to expand our horizons and see what the added dimension of constitution brings to the mix.</p>

<p>Though it’s a bit of a stretch, one way to think about this shift in approach is to compare the relationship of classical mechanics to quantum mechanics. You know how in physics class they teach you a bunch of classical mechanics stuff like Newtonian theory and so on, and then after you think you’ve more or less mastered that, they come along and tell you it was all bunk, and classical physics gives you only part of the picture, and there’s actually this other thing called quantum mechanics that really explains how things work at a lower level, but it didn’t make sense to complicate matters up front by trying to teach you both at once, and...oh wait...we also haven’t fully reconciled everything between the two yet, so just squint at it and trust us that it all makes sense somehow? Well this is a lot like that, except your brain will hurt less because physics is way harder than data processing, and you won’t have to squint at anything and pretend it makes sense because it actually does come together beautifully in the end, which is really cool.</p>

<p>So, with the stage appropriately set, the point of this chapter is twofold:</p>

<ul>
	<li>
	<p>To try to describe the relationship <a contenteditable="false" data-primary="Beam Model" data-type="indexterm" id="idm140176513833024"></a>between the Beam Model (as we’ve described it in the book up to this point) and <a contenteditable="false" data-primary="streams and tables" data-secondary="relationship between Beam Model and" data-type="indexterm" id="idm140176513831808"></a>the theory of “streams and tables” (as popularized by <a href="http://bit.ly/2LO0cik">Martin Kleppmann</a> and <a href="http://bit.ly/2sX0bl8">Jay Kreps</a>, among others, but essentially originating out of the database world). It turns out that stream and table theory does an illuminating job of describing the low-level concepts that underlie the Beam Model. Additionally, a clear understanding of how they relate is particularly informative when considering how robust stream processing concepts might be cleanly integrated into SQL (something we consider in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch08.html#streaming_sql">Chapter&nbsp;8</a>).<a contenteditable="false" data-primary="tables and streams" data-see="streams and tables" data-type="indexterm" id="idm140176513827456"></a></p>
	</li>
	<li>
	<p>To bombard you with bad physics analogies for the sheer fun of it. Writing a book is a lot of work; you have to find little joys here and there to keep you going.</p>
	</li>
</ul>

<section data-type="sect1" data-pdf-bookmark="Stream-and-Table Basics Or: a Special Theory of Stream and Table Relativity"><div class="sect1" id="idm140176513824752">
<h1>Stream-and-Table Basics Or: a Special Theory of Stream and Table Relativity</h1>

<p>The basic idea of streams and tables derives from the database world. <a contenteditable="false" data-primary="streams and tables" data-secondary="special theory of stream and table relativity" data-type="indexterm" id="idm140176513823216"></a>Anyone familiar with SQL is likely familiar with tables and their core properties, roughly summarized as: tables contain rows and columns of data, and each row is uniquely identified by some sort of key, either explicit or implicit.</p>

<p>If you <a contenteditable="false" data-primary="database systems" data-type="indexterm" id="idm140176513821008"></a>think back to your database systems class in college,<sup><a data-type="noteref" id="idm140176513819744-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513819744" class="totri-footnote">1</a></sup> you’ll probably recall the<a contenteditable="false" data-primary="append-only logs" data-type="indexterm" id="idm140176513818720"></a> data structure underlying most databases is an <em>append-only log</em>. As transactions are applied to a table in the database, those transactions are recorded in a log, the contents of which are then serially applied to the table to materialize those updates. In streams and tables nomenclature, that log is effectively the stream.</p>

<p>From that perspective, we now understand how to create a table from a stream: the table is just the result of applying the transaction log of updates found in the stream. But how to do we create a stream from a table? It’s essentially the inverse: a stream is a changelog for a table. <a contenteditable="false" data-primary="materialized views" data-type="indexterm" id="idm140176513816048"></a>The motivating example typically used for table-to-stream conversion is <em>materialized views</em>. Materialized views in SQL let you specify a query on a table, which itself is then manifested by the database system as another first-class table. This materialized view is essentially a cached version of that query, which the database system ensures is always up to date as the contents of the source table evolve over time. Perhaps unsurprisingly, materialized views are implemented via the changelog for the original table; any time the source table changes, that change is logged. The database then evaluates that change within the context of the materialized view’s query and applies any resulting change to the destination materialized view table.</p>

<p>Combining these two points together and employing yet another questionable physics analogy, we arrive at what one might call the Special Theory of Stream and Table Relativity:</p>

<dl>
	<dt>Streams <span class="roman">→</span> tables</dt>
	<dd>
	<p>The aggregation of a stream of updates over time yields a table.</p>
	</dd>
	<dt>Tables <span class="roman">→</span> streams</dt>
	<dd>
	<p>The observation of changes to a table over time yields a stream.</p>
	</dd>
</dl>

<p>This is a very powerful pair of concepts, and their careful application to the world of stream processing is a big reason for the massive success of Apache Kafka, the ecosystem that is built around these underlying principles. However, those statements themselves are not quite general enough to allow us to tie streams and tables to all of the concepts in the Beam Model. For that, we must go a little bit deeper.</p>

<section data-type="sect2" data-pdf-bookmark="Toward a General Theory of Stream and Table Relativity"><div class="sect2" id="idm140176513807376">
<h2>Toward a General Theory of Stream and Table Relativity</h2>

<p>If we want to reconcile stream/table theory with everything we know of the Beam Model, we’ll need to tie up some loose ends,<a contenteditable="false" data-primary="streams and tables" data-secondary="toward a general theory of stream and table relativity" data-type="indexterm" id="idm140176513805696"></a> specifically:</p>

<ul>
	<li>
	<p>How does batch processing fit into all of this?</p>
	</li>
	<li>
	<p>What is the relationship of streams to bounded and unbounded datasets?</p>
	</li>
	<li>
	<p>How do the four <em><span class="what_lt">what</span></em>, <em><span class="where_lt">where</span></em>, <em><span class="when_lt">when</span></em>, <em><span class="how_lt">how</span></em> questions map onto a streams/tables world?</p>
	</li>
</ul>

<p>As we attempt to do so, it will be helpful to have the right mindset about streams and tables. In addition to understanding them in relation to each other, as captured by the previous definition, it can be illuminating to define them independent of each other. Here’s a simple way of looking at it that will underscore some of our future analyses:</p>

<ul>
	<li>
	<p>Tables are data <em>at rest</em>.</p>

	<p>This isn’t to say tables are static in any way; <a contenteditable="false" data-primary="tables" data-secondary="as data at rest" data-type="indexterm" id="idm140176513794496"></a>nearly all useful tables are continuously changing over time in some way. But at any given time, a snapshot of the table provides some sort of picture of the dataset contained together as a whole.<sup><a data-type="noteref" id="idm140176513792784-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513792784" class="totri-footnote">2</a></sup> In that way, tables act as a conceptual resting place for data to accumulate and be observed over time. Hence, data at rest.</p>
	</li>
	<li>
	<p>Streams are data <em>in motion</em>.</p>

	<p>Whereas tables capture a view of the dataset as a whole<a contenteditable="false" data-primary="streams" data-secondary="as data in motion" data-type="indexterm" id="idm140176513789968"></a> at a <em>specific point in time</em>, streams capture the evolution of that data <em>over time</em>. Julian Hyde is fond of saying streams are like the derivatives of tables, and tables the integrals of streams, which is a nice way of thinking about it for you math-minded individuals out there. Regardless, the important feature of streams is that they capture the inherent movement of data within a table as it changes. Hence, data in motion.</p>
	</li>
</ul>

<p>Though tables and streams are intimately related, it’s important to keep in mind that they are very much <em>not</em> the same thing, even if there are many cases in which one might be fully derived from the other. The differences are subtle but important, as we’ll see.</p>
</div></section>
</div></section>

<section data-type="sect1" data-pdf-bookmark="Batch Processing Versus Streams and Tables"><div class="sect1" id="idm140176513785648">
<h1>Batch Processing Versus Streams and Tables</h1>

<p>With our <a contenteditable="false" data-primary="streams and tables" data-secondary="batch processing vs." data-type="indexterm" id="ix_strmtblbtch"></a>proverbial knuckles now cracked, let’s start to tie up some loose ends.<a contenteditable="false" data-primary="batch processing" data-secondary="vs. streams and tables" data-type="indexterm" id="ix_btchstrtbl"></a> To begin, we tackle the first one, regarding batch processing. At the end, we’ll discover that the resolution to the second issue, regarding the relationship of streams to bounded and unbounded data, will fall out naturally from the answer for the first. Score one for serendipity.</p>

<section data-type="sect2" data-pdf-bookmark="A Streams and Tables Analysis of MapReduce"><div class="sect2" id="idm140176513780272">
<h2>A Streams and Tables Analysis of MapReduce</h2>

<p>To keep our analysis relatively simple, but solidly <a contenteditable="false" data-primary="streams and tables" data-secondary="batch processing vs." data-tertiary="streams and tables analysis of MapReduce" data-type="indexterm" id="ix_strtblbtchMR"></a>concrete, as it were,<a contenteditable="false" data-primary="MapReduce" data-secondary="streams and tables analysis of" data-type="indexterm" id="ix_MRsttb"></a> let’s look at how a traditional <a href="http://bit.ly/2uvKRe6">MapReduce</a> job fits into the streams/tables world. As alluded to by its name, a MapReduce job superficially consists of two phases: Map and Reduce. For our purposes, though, it’s useful to look a little deeper and treat it more like six:</p>

<dl>
	<dt>MapRead</dt>
	<dd>
	<p>This consumes the input data and preprocesses them a bit into a standard key/value form for mapping.</p>
	</dd>
	<dt>Map</dt>
	<dd>
	<p>This repeatedly (and/or in parallel) consumes a single key/value pair<sup><a data-type="noteref" id="idm140176513770512-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513770512" class="totri-footnote">3</a></sup> from the preprocessed input and outputs zero or more key/value pairs.</p>
	</dd>
	<dt>MapWrite</dt>
	<dd>
	<p>This clusters together sets of Map-phase output values having identical keys and writes those key/value-list groups to (temporary) persistent storage. In this way, the MapWrite phase is essentially a group-by-key-and-checkpoint operation.</p>
	</dd>
	<dt>ReduceRead</dt>
	<dd>
	<p>This consumes the saved shuffle data and converts them into a standard key/value-list form for reduction.</p>
	</dd>
	<dt>Reduce</dt>
	<dd>
	<p>This repeatedly (and/or in parallel) consumes a single key and its associated value-list of records and outputs zero or more records, all of which may optionally remain associated with that same key.</p>
	</dd>
	<dt>ReduceWrite</dt>
	<dd>
	<p>This writes the outputs from the Reduce phase to the output datastore.</p>
	</dd>
</dl>

<p>Note that the MapWrite and ReduceRead phases sometimes are referred to in aggregate as the Shuffle phase, but for our purposes, it’s better to consider them independently. It’s perhaps also worth noting that the functions served by the MapRead and ReduceWrite phases are more commonly referred to these days as sources and sinks. Digressions aside, however, let’s now see how this all relates to streams and tables.</p>

<section data-type="sect3" data-pdf-bookmark="Map as streams/tables"><div class="sect3" id="idm140176513762528">
<h3>Map as streams/tables</h3>

<p>Because we start and end with static<sup><a data-type="noteref" id="idm140176513760720-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513760720" class="totri-footnote">4</a></sup> datasets, it should be clear that we begin with a table and end with a table. <a contenteditable="false" data-primary="MapReduce" data-secondary="streams and tables analysis of" data-tertiary="Map as streams/tables" data-type="indexterm" id="idm140176513759520"></a>But what do we have in between? Naively, one might assume that it’s tables all the way down; after all, batch processing is (conceptually) known to consume and produce tables. And if you think of a batch processing job as a rough analog of executing a classic SQL query, that feels relatively natural. But let’s look a little more closely at what’s really happening, step by step.</p>

<p>First up, MapRead consumes a table and produces <em>something</em>. That something is consumed next by the Map phase, so if we want to understand its nature, a good place to start would be with the Map phase API, which looks something like this in Java:</p>

<pre data-code-language="java" data-type="programlisting"><code class="kt">void</code> <code class="nf">map</code><code class="o">(</code><code class="n">KI</code> <code class="n">key</code><code class="o">,</code> <code class="n">VI</code> <code class="n">value</code><code class="o">,</code> <code class="n">Emit</code><code class="o">&lt;</code><code class="n">KO</code><code class="o">,</code> <code class="n">VO</code><code class="o">&gt;</code> <code class="n">emitter</code><code class="o">);</code>
</pre>

<p>The map call will be repeatedly invoked for each key/value pair in the input table. If you think this sounds suspiciously like the input table is being consumed as a stream of records, you’d be right. We look more closely at how the table is being converted into a stream later, but for now, suffice it to say that the MapRead phase is iterating over the data at rest in the input table and putting them into motion in the form of a stream that is then consumed by the Map phase.</p>

<p>Next up, the Map phase consumes that stream, and then does what? Because the map operation is an element-wise transformation, it’s not doing anything that will halt the moving elements and put them to rest. It might change the effective cardinality of the stream by either filtering some elements out or exploding some elements into multiple elements, but those elements all remain independent from one another after the Map phase concludes. So, it seems safe to say that the Map phase both consumes a stream as well as produces a stream.</p>

<p>After the Map phase is done, we enter the MapWrite phase. As I noted earlier, the MapWrite groups records by key and then writes them in that format to persistent storage. The <em>persistent</em> part of the write actually isn’t strictly necessary at this point as long as there’s persistence <em>somewhere</em> (i.e., if the upstream inputs are saved and one can recompute the intermediate results from them in cases of failure, similar to the approach Spark takes with Resilient Distributed Datasets [RDDs]). What <em>is</em> important is that the records are grouped together into some kind of datastore, be it in memory, on disk, or what have you. This is important because, as a result of this grouping operation, records that were previously flying past one-by-one in the stream are now brought to rest in a location dictated by their key, thus allowing per-key groups to accumulate as their like-keyed brethren and sistren arrive. Note how similar this is to the definition of stream-to-table conversion provided earlier: <em>the aggregation of a stream of updates over time yields a table</em>. The MapWrite phase, by virtue of grouping the stream of records by their keys, has put those data to rest and thus converted the stream back into a table.<sup><a data-type="noteref" id="idm140176513494944-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513494944" class="totri-footnote">5</a></sup> Cool!</p>

<p>We’re now halfway through the MapReduce, so, using <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#map_phases_in_a_mapreduce_data_in_a_table_are_converted">Figure&nbsp;6-1</a>, let’s recap what we’ve seen so far.</p>

<p>We’ve gone from table to stream and back again across three operations. MapRead converted the table into a stream, which was then transformed into a new stream by Map (via the user’s code), which was then converted back into a table by MapWrite. We’re going to find that the next three operations in the MapReduce look very similar, so I’ll go through them more quickly, but I still want to point out one important detail along the way.</p>

<figure class="smallertwenty"><div id="map_phases_in_a_mapreduce_data_in_a_table_are_converted" class="figure"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0601.png" width="195" height="800" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0601.png">
<h6><span class="label">Figure 6-1. </span>Map phases in a MapReduce. Data in a table are converted to a stream and back again.</h6>
</div></figure>
</div></section>

<section data-type="sect3" data-pdf-bookmark="Reduce as streams/tables"><div class="sect3" id="idm140176513761904">
<h3>Reduce as streams/tables</h3>

<p>Picking up where we left<a contenteditable="false" data-primary="MapReduce" data-secondary="streams and tables analysis of" data-tertiary="Reduce as streams/tables" data-type="indexterm" id="idm140176513487824"></a> off after the MapWrite phase, ReduceRead itself is relatively uninteresting. It’s basically identical to MapRead, except that the values being read are singleton lists of values instead of singleton values, because the data stored by MapWrite were key/value-list pairs. But it’s still just iterating over a snapshot of a table to convert it into a stream. Nothing new here.</p>

<p>And even though it <em>sounds</em> like it might be interesting, Reduce in this context is really just a glorified Map phase that happens to receive a list of values for each key instead of a single value. So it’s still just mapping single (composite) records into zero or more new records. Nothing particularly new here, either.</p>

<p>ReduceWrite is the one that’s a bit noteworthy. We know already that this phase must convert a stream to a table, given that Reduce produces a stream and the final output is a table. But how does that happen? If I told you it was a direct result of key-grouping the outputs from the previous phase into persistent storage, just like we saw with MapWrite, you might believe me, until you remembered that I noted earlier that key-association was an <em>optional</em> feature of the Reduce phase. With that feature enabled, ReduceWrite <em>is</em> essentially identical to MapWrite.<sup><a data-type="noteref" id="idm140176513482816-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513482816" class="totri-footnote">6</a></sup> But if that feature is disabled and the outputs from Reduce have no associated keys, what exactly is happening to bring those data to rest?</p>

<p>To understand what’s going on, it’s useful to think again of the semantics of a SQL table. Though often recommended, it’s not strictly required for a SQL table to have a primary key uniquely identifying each row. In the case of keyless tables, each row that is inserted is considered to be a new, independent row (even if the data therein are identical to one or more extant rows in the table), much as though there were an implicit AUTO_INCREMENT field being used as the key (which incidentally, is what’s effectively happening under the covers in most implementations, even though the “key” in this case might just be some physical block location that is never exposed or expected to be used as a logical identifier). This implicit unique key assignment is precisely what’s happening in ReduceWrite with unkeyed data. Conceptually, there’s still a group-by-key operation happening; that’s what brings the data to rest. But lacking a user-supplied key, the ReduceWrite is treating each record as though it has a new, never-before-seen key, and effectively grouping each record with itself, resulting again in data at rest.<sup><a data-type="noteref" id="idm140176513479936-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513479936" class="totri-footnote">7</a></sup></p>

<p>Take a look at <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#map_and_reduce_phases_in_a_mapreduce">Figure&nbsp;6-2</a>, which shows the entire pipeline from the perspective of stream/tables. You can see that it’s a sequence of TABLE → STREAM → STREAM → TABLE → STREAM → STREAM → TABLE. Even though we’re processing bounded data and even though we’re doing what we traditionally think of as batch processing, it’s really just streams and tables under the covers.</p>

<figure><div id="map_and_reduce_phases_in_a_mapreduce" class="figure"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0602.png" width="105" height="800" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0602.png">
<h6><span class="label">Figure 6-2. </span>Map and Reduce phases in a MapReduce, viewed from the perspective of streams and tables</h6>
</div></figure>
</div></section>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Reconciling with Batch Processing"><div class="sect2" id="idm140176513475520">
<h2>Reconciling with Batch Processing</h2>

<p>So where<a contenteditable="false" data-primary="streams and tables" data-secondary="batch processing vs." data-startref="ix_strtblbtchMR" data-tertiary="streams and tables analysis of MapReduce" data-type="indexterm" id="idm140176513474144"></a> does<a contenteditable="false" data-primary="MapReduce" data-secondary="streams and tables analysis of" data-startref="ix_MRsttb" data-type="indexterm" id="idm140176513472032"></a> this leave us with respect to our first two questions?</p>

<ol>
	<li>
	<p><strong>Q: </strong>How does batch<a contenteditable="false" data-primary="streams and tables" data-secondary="batch processing vs." data-tertiary="how batch processing fits into stream/table theory" data-type="indexterm" id="idm140176513468864"></a> processing fit into <a contenteditable="false" data-primary="batch processing" data-secondary="vs. streams and tables" data-tertiary="reconciling the two" data-type="indexterm" id="idm140176513466960"></a>stream/table theory?</p>

	<p><strong>A:</strong> Quite nicely. The basic pattern is as follows:</p>

	<ol style="padding-left:2ex">
		<li>
		<p>Tables are read in their entirety to become streams.</p>
		</li>
		<li>
		<p>Streams are processed into new streams until a grouping operation is hit.</p>
		</li>
		<li>
		<p>Grouping turns the stream into a table.</p>
		</li>
		<li>
		<p>Steps a through c repeat until you run out of stages in the pipeline.</p>
		</li>
	</ol>
	</li>
	<li>
	<p><strong>Q:</strong> How do streams <a contenteditable="false" data-primary="streams and tables" data-secondary="batch processing vs." data-tertiary="how streams relate to bounded/unbounded data" data-type="indexterm" id="idm140176513458848"></a>relate to bounded/unbounded data?</p>

	<p><strong>A:</strong> As we can see from the MapReduce example, streams are simply the in-motion form of data, regardless of whether they’re bounded or unbounded.</p>
	</li>
</ol>

<p>Taken from this perspective, it’s easy to see that stream/table theory isn’t remotely at odds with batch processing of bounded data. In fact, it only further supports the idea I’ve been harping on that batch and streaming really aren’t that different: at the end of the of day, it’s streams and tables all the way down.</p>

<p>With that, we’re well on our way toward a general theory of streams and tables. But to wrap things up cleanly, we last need to revisit the four <em><span class="what_lt">what</span></em>/<em><span class="where_lt">where</span></em>/<em><span class="when_lt">when</span></em>/<em><span class="how_lt">how</span></em> questions within the streams/tables context, to see how they all relate.<a contenteditable="false" data-primary="streams and tables" data-secondary="batch processing vs." data-startref="ix_strmtblbtch" data-type="indexterm" id="idm140176513450816"></a><a contenteditable="false" data-primary="batch processing" data-secondary="vs. streams and tables" data-startref="ix_btchstrtbl" data-type="indexterm" id="idm140176513449200"></a></p>
</div></section>
</div></section>

<section data-type="sect1" data-pdf-bookmark="What, Where, When, and How in a Streams and Tables World"><div class="sect1" id="idm140176513447424">
<h1><em><span class="what_lt">What</span></em>, <em><span class="where_lt">Where</span></em>, <em><span class="when_lt">When</span></em>, and <em><span class="how_lt">How</span></em> in a Streams and Tables World</h1>

<p>In this section, we look at each of the four questions and <a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-type="indexterm" id="idm140176513442656"></a>see how they relate to streams and tables. We’ll also answer any questions that may be lingering from the previous section, one big one being: if grouping is the thing that brings data to rest, what precisely is the “ungrouping” inverse that puts them in motion? More on that later. But for now, on to transformations.</p>

<section data-type="sect2" data-pdf-bookmark="What: Transformations"><div class="sect2" id="idm140176513440544">
<h2><em><span class="what_lt">What</span></em>: Transformations</h2>

<p>In <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch03.html#watermarks_chapter">Chapter&nbsp;3</a>, we learned that transformations <a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-tertiary="what, transformations" data-type="indexterm" id="ix_strmtblwha"></a>tell us <em><span class="what_lt">what</span></em> the pipeline is computing; that is, whether it’s building models, counting sums, filtering spam, and so on.<a contenteditable="false" data-primary="transformations" data-secondary="in streams and tables model" data-type="indexterm" id="ix_transwh"></a> We saw in the earlier MapReduce example<a contenteditable="false" data-primary="MapReduce" data-secondary="stages answering what questions" data-type="indexterm" id="idm140176513432080"></a> that four of the six stages answered <em><span class="what_lt">what</span></em> <span class="keep-together">questions</span>:</p>

<ul>
	<li>
	<p>Map and Reduce both applied the pipeline author’s element-wise transformation on each key/value or key/value-list pair in the input stream, respectively, yielding a new, transformed stream.</p>
	</li>
	<li>
	<p>MapWrite and ReduceWrite both grouped the outputs from the previous stage according to the key assigned by that stage (possibly implicitly, in the optional Reduce case), and in doing so transformed the input stream into an output table.</p>
	</li>
</ul>

<p>Viewed in that light, you can see that there are essentially two types of <em><span class="what_lt">what</span></em> transforms from the perspective of stream/table theory:</p>

<dl>
	<dt>Nongrouping</dt>
	<dd>
	<p>These operations (as we saw in Map and Reduce) simply<a contenteditable="false" data-primary="nongrouping transformations" data-type="indexterm" id="idm140176513423664"></a> accept a stream of records and produce a new, transformed stream of records on the other side. Examples of nongrouping transformations are filters (e.g., removing spam messages), exploders (i.e., splitting apart a larger composite record into its constituent parts), and mutators (e.g., divide by 100), and so on.</p>
	</dd>
	<dt>Grouping</dt>
	<dd>
	<p>These <a contenteditable="false" data-primary="grouping transformations" data-type="indexterm" id="idm140176513420768"></a>operations (as we saw in MapWrite and ReduceWrite) accept a stream of records and group them together in some way, thereby transforming the stream into a table. Examples of grouping transformations are joins, aggregations, list/set accumulation, changelog application, histogram creation, machine learning model training, and so forth.</p>
	</dd>
</dl>

<p>To get a better sense for how all of this ties together, let’s look at an updated version of <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch02.html#types_of_transformations">Figure&nbsp;2-2</a>, where we first began to look at transformations. To save you jumping back there to see what we were talking about, <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#summation_pipeline_key_value_data_are_read">Example&nbsp;6-1</a> contains the code snippet we were using.</p>

<div data-type="example" id="summation_pipeline_key_value_data_are_read">
<h5><span class="label">Example 6-1. </span>Summation pipeline</h5>

<pre data-type="programlisting">PCollection&lt;String&gt; raw = IO.read(...);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; input = raw.apply(<span class="what_lt">new ParseFn()</span>);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; totals =
  input.apply(<span class="what_lt">Sum.integersPerKey()</span>);
</pre>
</div>

<p>This pipeline is simply <a contenteditable="false" data-primary="batch processing" data-secondary="event-time and processing-time view of" data-type="indexterm" id="idm140176513384848"></a>reading in input data, parsing individual team member scores, and then summing those scores per team. <a contenteditable="false" data-primary="processing time" data-secondary="view of batch processing" data-type="indexterm" id="idm140176513383168"></a><a contenteditable="false" data-primary="event time" data-secondary="view of batch processing" data-type="indexterm" id="idm140176513381776"></a>The event-time/processing-time visualization of it looks like the diagram presented in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#event_time_processing_time_view_of_classic_batch_processing">Figure&nbsp;6-3</a>.</p>

<figure><div id="event_time_processing_time_view_of_classic_batch_processing" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0603.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0603.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0603.png" alt="Event-time/processing-time view of classic batch processing" width="600" height="366" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0603.png">
</video>
<h6><span class="label">Figure 6-3. </span>Event-time/processing-time view of classic batch processing</h6>
</div></figure>

<p><a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#stream_and_tables_view_of_classic_batch_processing">Figure&nbsp;6-4</a> depicts a more topological view of this pipeline over time, rendered from a streams-and-tables perspective.</p>

<figure><div id="stream_and_tables_view_of_classic_batch_processing" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0604.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0604.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0604.png" alt="Streams and tables view of classic batch processing" width="600" height="328" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0604.png">
</video>
<h6><span class="label">Figure 6-4. </span>Streams and tables view of classic batch processing</h6>
</div></figure>

<p>In the streams and tables version of this visualization, the passage of time is manifested by scrolling the graph area downward in the processing-time dimension (y-axis) as time advances. The nice thing about rendering things this way is that it very clearly calls out the difference between nongrouping and grouping operations. Unlike our previous diagrams, in which I elided all initial transformations in the pipeline other than the <code>Sum.integersByKey</code>, I’ve included the initial parsing operation here, as well, because the nongrouping aspect of the parsing operation provides a nice contrast to the grouping aspect of the summation. Viewed in this light, it’s very easy to see the difference between the two. The nongrouping operation does nothing to halt the motion of the elements in the stream, and as a result yields another stream on the other side. In contrast, the grouping operation brings all the elements in the stream to rest as it adds them together into the final sum. Because this example was running on a batch processing engine over bounded data, the final results are emitted only after the end of the input is reached. As we noted in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch02.html#the_what_where_when_and_how">Chapter&nbsp;2</a> this example is sufficient for bounded data, but is too limiting in the context of unbounded data because the input will theoretically never end. But is it really insufficient?</p>

<p>Looking at the new streams/tables portion of the diagram, if all we’re doing is calculating sums as our final results (and not actually transforming those sums in any additional way further downstream within the pipeline), the table we created with our grouping operation has our answer sitting right there, evolving over time as new data arrive. Why don’t we just read our results from there?</p>

<p>This is exactly the point being made by the folks championing stream processors as a database<sup><a data-type="noteref" id="idm140176513364064-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513364064" class="totri-footnote">8</a></sup> (primarily the Kafka and Flink crews): anywhere you have a grouping operation in your pipeline, you’re creating a table that includes what is effectively the output values of that portion of the stage. If those output values happen to be the final thing your pipeline is calculating, you don’t need to rematerialize them somewhere else if you can read them directly out of that table. Besides providing quick and easy access to results as they evolve over time, this approach saves on compute resources by not requiring an additional sink stage in the pipeline to materialize the outputs, yields disk savings by eliminating redundant data storage, and obviates the need for any engineering work building the aforementioned sink stages.<sup><a data-type="noteref" id="idm140176513362432-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513362432" class="totri-footnote">9</a></sup> The only major caveat is that you need to take care to ensure that only the data processing pipeline has the ability to make modifications to the table. If the values in the table can change out from under the pipeline due to external modification, all bets are off regarding consistency guarantees.</p>

<p>A number of folks in the industry have been recommending this approach for a while now, and it’s being put to great use in a variety of scenarios. We’ve seen MillWheel customers within Google do the same thing by serving data directly out of their Bigtable-based state tables, and we’re in the process of adding first-class support for accessing state from outside of your pipeline in the C++–based Apache Beam equivalent we use internally at Google (Google Flume); hopefully those concepts will make their way to Apache Beam proper someday soon, as well.</p>

<p>Now, reading from the state tables is great if the values therein are your final results. But, if you have more processing to perform downstream in the pipeline (e.g., imagine our pipeline was actually computing the top scoring team), we still need some better way to cope with unbounded data, allowing us to transform the table back into a stream in a more incremental fashion. For that, we’ll want to journey back through the remaining three questions, beginning with windowing, expanding into triggering, and <a contenteditable="false" data-primary="transformations" data-secondary="in streams and tables model" data-startref="ix_transwh" data-type="indexterm" id="idm140176513359344"></a>finally tying it all <a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-startref="ix_strmtblwha" data-tertiary="what, transformations" data-type="indexterm" id="idm140176513357504"></a>together with accumulation.</p>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Where: Windowing"><div class="sect2" id="idm140176513439920">
<h2><em><span class="where_lt">Where</span></em>: Windowing</h2>

<p>As we know from <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch03.html#watermarks_chapter">Chapter&nbsp;3</a>, windowing<a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-tertiary="where, windowing" data-type="indexterm" id="ix_strmtblwh"></a> tells us <span class="where_lt"><em>where</em></span> in event time grouping occurs.<a contenteditable="false" data-primary="windowing" data-secondary="in streams and tables model" data-type="indexterm" id="ix_windstrtbl"></a> Combined with our earlier experiences, we can thus also infer it must play a role in stream-to-table conversion because grouping is what drives table creation. There are really two aspects of windowing that interact with stream/table theory:</p>

<dl>
	<dt>Window assignment</dt>
	<dd>
	<p>This effectively just means placing a record <a contenteditable="false" data-primary="assignment (window)" data-secondary="in streams and tables model" data-type="indexterm" id="idm140176513345488"></a>into one or more windows.</p>
	</dd>
	<dt>Window merging</dt>
	<dd>
	<p>This is the logic that makes<a contenteditable="false" data-primary="merging windows" data-type="indexterm" id="idm140176513342512"></a> dynamic, data-driven types of windows, such as sessions, possible.</p>
	</dd>
</dl>

<p>The effect of window assignment is quite straightforward. When a record is conceptually placed into a window, the definition of the window is essentially combined with the user-assigned key for that record to create an implicit composite key used at grouping time.<sup><a data-type="noteref" id="idm140176513340240-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513340240">10</a></sup> Simple.</p>

<p>For completeness, let’s take another look at the original windowing example from <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch03.html#watermarks_chapter">Chapter&nbsp;3</a>, but from a streams and tables perspective. If you recall, the code snippet looked something like <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#summation_pipeline_chap_six_second">Example&nbsp;6-2</a> (with parsing <em>not</em> elided this time).</p>

<div data-type="example" id="summation_pipeline_chap_six_second">
<h5><span class="label">Example 6-2. </span>Summation pipeline</h5>

<pre data-type="programlisting">PCollection&lt;String&gt; raw = IO.read(...);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; input = raw.apply(<span class="what_lt">new ParseFn()</span>);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; totals = input
  <span class="yellow_bg">.apply(<span class="where_lt">Window.into(FixedWindows.of(TWO_MINUTES))</span>)</span>
  .apply(<span class="what_lt">Sum.integersPerKey()</span>);
</pre>
</div>

<p>And the original visualization looked like that shown in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#event_time_process_time_view_of_windowed_summation_on_a_batch_engine">Figure&nbsp;6-5</a>.</p>

<figure><div id="event_time_process_time_view_of_windowed_summation_on_a_batch_engine" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0605.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0605.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0605.png" alt="Event-time/processing-time view of windowed summation on a batch engine" width="600" height="366" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0605.png">
</video>
<h6><span class="label">Figure 6-5. </span>Event-time/processing-time view of windowed summation on a batch engine</h6>
</div></figure>

<p>And now, <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#streams_and_tables_view_of_windowed_summation_on_a_batch_engine">Figure&nbsp;6-6</a> shows the streams and tables version.</p>

<figure><div id="streams_and_tables_view_of_windowed_summation_on_a_batch_engine" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0606.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0606.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0606.png" alt="Streams and tables view of windowed summation on a batch engine" width="600" height="328" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0606.png">
</video>
<h6><span class="label">Figure 6-6. </span>Streams and tables view of windowed summation on a batch engine</h6>
</div></figure>

<p>As you might expect, this looks remarkably similar to <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#stream_and_tables_view_of_classic_batch_processing">Figure&nbsp;6-4</a>, but with four groupings in the table (corresponding to the four windows occupied by the data) instead of just one.<a contenteditable="false" data-primary="batch processing" data-secondary="streams and tables view of windowed summation on batch engine" data-type="indexterm" id="idm140176513316704"></a> But as before, we must wait until the end of our bounded input is reached before emitting results. We look at how to address this for unbounded data in the next section, but first let’s touch briefly on merging windows.</p>

<section data-type="sect3" data-pdf-bookmark="Window merging"><div class="sect3" id="idm140176513314816">
<h3>Window merging</h3>

<p>Moving on to merging, we’ll find that the effect of window merging is more complicated than window assignment, but still straightforward when you think about the logical operations that would need to happen. <a contenteditable="false" data-primary="merging windows" data-secondary="in streams and tables model" data-type="indexterm" id="idm140176513313088"></a>When grouping a stream into windows that can merge, that grouping operation has to take into account all of the windows that could possibly merge together. Typically, this is limited to windows whose data all have the same key (because we’ve already established that windowing modifies grouping to not be just by key, but also key and window). For this reason, the system doesn’t really treat the key/window pair as a flat composite key, but rather as a hierarchical key, with the user-assigned key as the root, and the window a child component of that root. When it comes time to actually group data together, the system first groups by the root of the hierarchy (the key assigned by the user). After the data have been grouped by key, the system can then proceed with grouping by window within that key (using the child components of the hierarchical composite keys). This act of grouping by window is where window merging happens.</p>

<p>What’s interesting from a streams and tables perspective is how this window merging changes the mutations that are ultimately applied to a table; that is, how it modifies the changelog that dictates the contents of the table over time. With nonmerging windows, each new element being grouped results in a single mutation to the table (to add that element to the group for the element’s key+window). With merging windows, the act of grouping a new element can result in one or more existing windows being merged with the new window. So, the merging operation must inspect all of the existing windows for the current key, figure out which windows can merge with this new window, and then atomically commit deletes for the old unmerged windows in conjunction with an insert for the new merged window into the table. This is why systems that support merging windows typically define the unit of atomicity/parallelization as key, rather than key+window. Otherwise, it would be impossible (or at least much more expensive) to provide the strong consistency needed for correctness guarantees. When you begin to look at it in this level of detail, you can see why it’s so nice to have the system taking care of the nasty business of dealing<a contenteditable="false" data-primary="Dataflow Model paper" data-type="indexterm" id="idm140176513308944"></a> with window merges. For an even closer view of window merging semantics, I refer you to section 2.2.2 of <a href="http://bit.ly/2sXgVJ3">“The Dataflow Model”</a>.</p>

<p>At the end of the day, windowing is really just a minor alteration to the semantics of grouping, which means it’s a minor alteration to the semantics of stream-to-table conversion. For window assignment, it’s as simple as incorporating the window into an implicit composite key used at grouping time. When window merging becomes involved, that composite key is treated more like a hierarchical key, allowing the system to handle the nasty business of grouping by key, figuring out window merges within that key, and then atomically applying all the necessary mutations to the corresponding table for us. Hooray for layers of abstraction!</p>

<p>All that said, we still haven’t actually addressed the problem of converting a table to a stream in a more incremental fashion in the case of unbounded data. For that, we need to revisit triggers.<a contenteditable="false" data-primary="windowing" data-secondary="in streams and tables model" data-startref="ix_windstrtbl" data-type="indexterm" id="idm140176513305392"></a><a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-startref="ix_strmtblwh" data-tertiary="where, windowing" data-type="indexterm" id="idm140176513303680"></a></p>
</div></section>
</div></section>

<section data-type="sect2" data-pdf-bookmark="When: Triggers"><div class="sect2" id="idm140176513354816">
<h2><em><span class="when_lt">When</span></em>: Triggers</h2>

<p>We learned in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch03.html#watermarks_chapter">Chapter&nbsp;3</a> that we use triggers <a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-tertiary="when, triggers" data-type="indexterm" id="ix_strmtblwhn"></a>to dictate <em><span class="when_lt">when</span></em> the contents<a contenteditable="false" data-primary="triggers" data-secondary="in streams and tables model" data-type="indexterm" id="ix_trigsttb"></a> of a window will be materialized (with watermarks providing a useful signal of input completeness for certain types of triggers). After data have been grouped together into a window, we use triggers to dictate when that data should be sent downstream. <a contenteditable="false" data-primary="grouping operations" data-secondary="grouping/ungrouping in streams and tables" data-type="indexterm" id="idm140176513292848"></a>In streams/tables terminology, we understand that grouping means stream-to-table conversion. From there, it’s a relatively small leap to see that triggers are the complement to grouping; in other words, that “ungrouping” operation we were grasping for earlier. Triggers are what drive table-to-stream conversion.</p>

<p>In streams/tables terminology, triggers are special procedures applied to a table that allow for data within that table to be materialized in response to relevant events. Stated that way, they actually sound suspiciously similar to classic database triggers. And indeed, the choice of name here was no coincidence; they are essentially the same thing. When you specify a trigger, you are in effect writing code that then is evaluated for every row in the state table as time progresses. When that trigger fires, it takes the corresponding data that are currently at rest in the table and puts them into motion, yielding a new stream.</p>

<p>Let’s return to our examples. We’ll begin with the simple per-record trigger from <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch02.html#the_what_where_when_and_how">Chapter&nbsp;2</a>, which simply emits a new result every time a new record arrives. The code and event-time/processing-time visualization for that example is shown in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#triggering_repeatedly_with_every_record_chap_six">Example&nbsp;6-3</a>. <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#per_record_triggering_on_a_streaming_engine_chap_six">Figure&nbsp;6-7</a> presents the results.</p>

<div data-type="example" id="triggering_repeatedly_with_every_record_chap_six">
<h5><span class="label">Example 6-3. </span>Triggering repeatedly with every record</h5>

<pre data-type="programlisting">PCollection&lt;String&gt;&gt; raw = IO.read(...);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; input = raw.apply(<span class="what_lt">new ParseFn()</span>);	
PCollection&lt;KV&lt;Team, Integer&gt;&gt; totals = input
  .apply(<span class="where_lt">Window.into(FixedWindows.of(TWO_MINUTES))</span>
               <span class="when_lt yellow_bg">.triggering(Repeatedly(AfterCount(1)))</span>);
  .apply(<span class="what_lt">Sum.integersPerKey()</span>);
</pre>
</div>

<figure><div id="per_record_triggering_on_a_streaming_engine_chap_six" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0607.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0607.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0607.png" alt="Per-record triggering on a streaming engine" width="600" height="366" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0607.png">
</video>
<h6><span class="label">Figure 6-7. </span>Streams and tables view of windowed summation on a batch engine</h6>
</div></figure>

<p>As before, new results are materialized every time a new record is encountered. Rendered in a streams and tables type of view, this diagram would look like <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#streams_and_tables_view_of_windowed_summation_with_per_record_triggering_on_a_streaming_engine">Figure&nbsp;6-8</a>.</p>

<figure><div id="streams_and_tables_view_of_windowed_summation_with_per_record_triggering_on_a_streaming_engine" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0608.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0608.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0608.png" alt="Streams and tables view of windowed summation with per-record triggering on a streaming engine" width="600" height="411" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0608.png">
</video>
<h6><span class="label">Figure 6-8. </span>Streams and tables view of windowed summation with per-record triggering on a streaming engine</h6>
</div></figure>

<p>An interesting side effect of using per-record triggers is how it somewhat masks the effect of data being brought to rest, given that they are then immediately put back into motion again by the trigger. <a contenteditable="false" data-primary="triggers" data-secondary="in streams and tables model" data-tertiary="per-record triggering in streaming engine" data-type="indexterm" id="idm140176513269440"></a>Even so, the aggregate artifact from the grouping remains at rest in the table, as the ungrouped stream of values flows away from it.</p>

<p>To get a better sense of the at-rest/in-motion relationship, let’s skip forward in our triggering examples to the basic watermark completeness streaming example from <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch02.html#the_what_where_when_and_how">Chapter&nbsp;2</a>, which simply emitted results when complete (due to the watermark passing the end of the window). The code and event-time/processing-time visualization for that example are presented in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#watermark_completeness_trigger_chap_six">Example&nbsp;6-4</a> (note that I’m only showing the heuristic watermark version here, for brevity and ease of comparison) and <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#event_time_processing_time_view_of_windowed_summation_with_a_heuristic_watermark_on_a_streaming_engine">Figure&nbsp;6-9</a> illustrates the results.</p>

<div data-type="example" id="watermark_completeness_trigger_chap_six">
<h5><span class="label">Example 6-4. </span>Watermark completeness trigger</h5>

<pre data-type="programlisting">PCollection&lt;String&gt; raw = IO.read(...);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; input = raw.apply(<span class="what_lt">new ParseFn()</span>);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; totals = input
  .apply(<span class="where_lt">Window.into(FixedWindows.of(TWO_MINUTES))</span>
               <span class="when_lt yellow_bg">.triggering(AfterWatermark())</span>)
  .apply(<span class="what_lt">Sum.integersPerKey()</span>);
</pre>
</div>

<figure><div id="event_time_processing_time_view_of_windowed_summation_with_a_heuristic_watermark_on_a_streaming_engine" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0609.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0609.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0609.png" alt="Event-time/processing-time view of windowed summation with a heuristic watermark on a streaming engine" width="600" height="417" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0609.png">
</video>
<h6><span class="label">Figure 6-9. </span>Event-time/processing-time view of windowed summation with a heuristic watermark on a streaming engine</h6>
</div></figure>

<p>Thanks to the trigger specified in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#watermark_completeness_trigger_chap_six">Example&nbsp;6-4</a>, which declares that windows should be materialized when the watermark passes them, the system is able to emit results in a progressive fashion as the otherwise unbounded input to the pipeline becomes more and more complete. Looking at the streams and tables version in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#streams_and_tables_view_of_windowed_summation">Figure&nbsp;6-10</a>, it looks as you might expect.</p>


<figure><div id="streams_and_tables_view_of_windowed_summation" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0610.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0610.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0610.png" alt="Streams and tables view of windowed summation with a heuristic watermark on a streaming engine" width="600" height="411" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0610.png">
</video>
<h6><span class="label">Figure 6-10. </span>Streams and tables view of windowed summation with a heuristic watermark on a streaming engine</h6>
</div></figure>

<p>In this version, you<a contenteditable="false" data-primary="triggers" data-secondary="in streams and tables model" data-tertiary="windowed summation with heuristic watermark on streaming engine" data-type="indexterm" id="idm140176513245248"></a> can see very clearly the ungrouping effect triggers have on the state table. As the watermark passes the end of each window, it pulls the result for that window out of the table and sets it in motion downstream, separate from all the other values in the table. We of course still have the late data issue from before, which we can solve<a contenteditable="false" data-primary="early/on-time/late triggers" data-secondary="in streams and tables model" data-type="indexterm" id="idm140176513243024"></a> again with the more comprehensive<a contenteditable="false" data-primary="triggers" data-secondary="in streams and tables model" data-tertiary="early/on-time/late firings" data-type="indexterm" id="idm140176513241488"></a> trigger shown in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#early_on_time_and_late_firings_via_the_early_on_time_late_api_chap_six">Example&nbsp;6-5</a>.</p>

<div data-type="example" id="early_on_time_and_late_firings_via_the_early_on_time_late_api_chap_six">
<h5><span class="label">Example 6-5. </span>Early, on-time, and late firings via the early/on-time/late API</h5>

<pre data-type="programlisting">PCollection&lt;String&gt; raw = IO.read(...);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; input = raw.apply(<span class="what_lt">new ParseFn()</span>);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; totals = input
  .apply(<span class="where_lt">Window.into(FixedWindows.of(TWO_MINUTES))</span>
               <span class="when_lt">.triggering(</span>
                 <span class="when_lt">AfterWatermark()</span>
                   <span class="when_lt yellow_bg">.withEarlyFirings(AlignedDelay(ONE_MINUTE))</span>
                   <span class="when_lt"><span class="yellow_bg">.withLateFirings(AfterCount(1))</span>)</span>)
  .apply(<span class="what_lt">Sum.integersPerKey()</span>);
</pre>
</div>

<p>The event-time/processing-time diagram looks like <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#even_time_processing_time_view_of_windowed_summation">Figure&nbsp;6-11</a>.</p>

<figure><div id="even_time_processing_time_view_of_windowed_summation" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0611.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0611.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0611.png" alt="Event-time/processing-time view of windowed summation on a streaming engine with early/on-time/late trigger" width="600" height="417" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0611.png">
</video>
<h6><span class="label">Figure 6-11. </span>Event-time/processing-time view of windowed summation on a streaming engine with early/on-time/late trigger</h6>
</div></figure>

<p>Whereas the streams and tables version looks like that shown in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#streams_and_tables_view_of_windowed_summation_on_a_streaming">Figure&nbsp;6-12</a>.</p>

<figure><div id="streams_and_tables_view_of_windowed_summation_on_a_streaming" class="figure">
<video style="margin: 0 auto; max-width: 100%;" controls="controls" poster="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0612.png" autoplay="autoplay" loop="loop">
<source src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0612.mp4" type="video/mp4"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0612.png" alt="Streams and tables view of windowed summation on a streaming engine with early/on-time/late trigger" width="600" height="411" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0612.png">
</video>
<h6><span class="label">Figure 6-12. </span>Streams and tables view of windowed summation on a streaming engine with early/on-time/late trigger</h6>
</div></figure>

<p>This version makes even more clear the ungrouping effect triggers have, rendering an evolving view of the various independent pieces of the table into a stream, as dictated by the triggers specified in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#our_full_score_parsing_pipeline">Example&nbsp;6-6</a>.</p>

<p>The semantics of all the concrete triggers we’ve talked about so far (event-time, processing-time, count, composites like early/on-time/late, etc.) are just as you would expect when viewed from the streams/tables perspective, so they aren’t worth further discussion. However, we haven’t yet spent much time talking about what triggers look like in a classic batch processing scenario. Now that we understand what the underlying streams/tables topology of a batch pipeline looks like, this is worth touching upon briefly.</p>

<p>At the end of the day, there’s really only one type of trigger used in classic batch scenarios: one that fires when the input is complete. For the initial MapRead stage of the MapReduce job we looked at earlier, that trigger would conceptually fire for all of the data in the input table as soon as the pipeline launched, given that the input for a batch job is assumed to be complete from the get go.<sup><a data-type="noteref" id="idm140176513214496-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513214496">11</a></sup> That input source table would thus be converted into a stream of individual elements, after which the Map stage could begin processing them.</p>

<p>For table-to-stream conversions in the middle of the pipeline, such as the ReduceRead stage in our example, the same type of trigger is used. In this case, however, the trigger must actually wait for all of the data in the table to be complete (i.e., what is more commonly referred to as all of the data being written to the shuffle), much as our example batch pipelines in Figures <a data-type="xref" data-xrefstyle="select:labelnumber" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#stream_and_tables_view_of_classic_batch_processing">6-4</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#streams_and_tables_view_of_windowed_summation_on_a_batch_engine">6-6</a> waited for the end of the input before emitting their final results.</p>

<p>Given that classic batch processing effectively always makes use of the input-data-complete trigger, you might ask what any custom triggers specified by the author of the pipeline might mean in a batch scenario. The answer here really is: it depends. There are two aspects worth discussing:</p>

<dl>
	<dt>Trigger guarantees (or lack thereof)</dt>
	<dd>
	<p>Most existing batch processing systems have been designed with this lock-step read-process-group-write-repeat sequence in mind.<a contenteditable="false" data-primary="triggers" data-secondary="in streams and tables model" data-tertiary="trigger guarantees (or lack of)" data-type="indexterm" id="idm140176513206736"></a> In such circumstances, it’s difficult to provide any sort of finer-grained trigger abilities, because the only place they would manifest any sort of change would be at the final shuffle stage of the pipeline. This doesn’t mean that the triggers specified by the user aren’t honored, however; the semantics of triggers are such that it’s possible to resort to lower common denominators when appropriate.</p>

	<p>For example, an <code>AfterWatermark</code> trigger is meant to trigger <em>after</em> the watermark passes the end of a window. It makes no guarantees how <em>far</em> beyond the end of the window the watermark may be when it fires. Similarly, an <code>AfterCount(N)</code> trigger only guarantees that <em>at least N</em> elements have been processed before triggering; <em>N</em> might very well be all of the elements in the input set.</p>

	<p>Note that this clever wording of trigger names wasn’t chosen simply to accommodate classic batch systems within the model; it’s a very necessary part of the model itself, given the natural asynchronicity and nondeterminism of triggering. Even in a finely tuned, low-latency, true-streaming system, it’s essentially impossible to guarantee that an <code>AfterWatermark</code> trigger will fire while the watermark is precisely <em>at</em> the end of any given window, except perhaps under the most extremely limited circumstances (e.g., a single machine processing all of the data for the pipeline with a relatively modest load). And even if you could guarantee it, what really would be the point? Triggers provide a means of controlling the flow of data from a table into a stream, nothing more.</p>
	</dd>
	<dt>The blending of batch and streaming</dt>
	<dd>
	<p>Given what we’ve learned in this writeup, it should be clear that the main semantic <a contenteditable="false" data-primary="triggers" data-secondary="in streams and tables model" data-tertiary="blending of batch and streaming" data-type="indexterm" id="idm140176513197664"></a>difference between batch and streaming systems is the ability to trigger tables incrementally.<a contenteditable="false" data-primary="batch processing" data-secondary="blending with streaming" data-type="indexterm" id="idm140176513195600"></a> But even that isn’t really a semantic difference, but more of a latency/throughput trade-off (because batch systems typically give you higher throughput at the cost of higher latency of results).</p>

	<p>This goes back to something I said in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch01.html#batch_and_streaming_efficiency_differnces">“Batch and Streaming Efficiency Differences”</a>: there’s really not that much difference between batch and streaming systems today except for an efficiency delta (in favor of batch) and a natural ability to deal with unbounded data (in favor of streaming). I argued then that much of that efficiency delta comes from the combination of larger bundle sizes (an explicit compromise of latency in favor of throughput) and more efficient shuffle implementations (i.e., stream → table → stream conversions). From that perspective, it should be possible to provide a system that seamlessly integrates the best of both worlds: one which provides the ability to handle unbounded data naturally but can also balance the tensions between latency, throughput, and cost across a broad spectrum of use cases by transparently tuning the bundle sizes, shuffle implementations, and other such implementation details under the covers.<a contenteditable="false" data-primary="Apache Beam" data-secondary="blending of batch and streaming" data-type="indexterm" id="idm140176513191520"></a></p>

	<p>This is precisely what Apache Beam already does at the API level.<sup><a data-type="noteref" id="idm140176513189696-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513189696">12</a></sup> The argument being made here is that there’s room for unification at the execution-engine level, as well. In a world like that, batch and streaming will no longer be a thing, and we’ll be able to say goodbye to both batch <em>and</em> streaming as independent concepts once and for all. We’ll just have general data processing systems that combine the best ideas from both branches in the family tree to provide an optimal experience for the specific use case at hand. Some day.</p>
	</dd>
</dl>

<p>At this point, we can stick a fork in the trigger section. It’s done. We have only one more brief stop on our way to having a holistic view of the relationship between the Beam <a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-startref="ix_strmtblwhn" data-tertiary="when, triggers" data-type="indexterm" id="idm140176513187040"></a>Model and <a contenteditable="false" data-primary="triggers" data-secondary="in streams and tables model" data-startref="ix_trigsttb" data-type="indexterm" id="idm140176513184976"></a>streams-and-tables theory: <em>accumulation</em>.</p>
</div></section>

<section data-type="sect2" data-pdf-bookmark="How: Accumulation"><div class="sect2" id="idm140176513300832">
<h2><em><span class="how_lt">How</span></em>: Accumulation</h2>

<p>In <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch02.html#the_what_where_when_and_how">Chapter&nbsp;2</a>, we learned that the three accumulation modes (discarding, accumulating, accumulating and retracting<sup><a data-type="noteref" id="idm140176513179920-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513179920">13</a></sup>) tell us how refinements of results relate when a window is triggered multiple times over the course of its life. <a contenteditable="false" data-primary="streams and tables" data-secondary="what, where, when, and how of" data-tertiary="how, accumulation" data-type="indexterm" id="idm140176513179072"></a><a contenteditable="false" data-primary="accumulation" data-secondary="in streams and tables model" data-type="indexterm" id="idm140176513177392"></a>Fortunately, the relationship to streams and tables here is pretty straightforward:</p>

<ul>
	<li>
	<p><em>Discarding mode</em> requires the system to either<a contenteditable="false" data-primary="discarding mode (accumulation)" data-type="indexterm" id="idm140176513174336"></a> throw away the previous value for the window when triggering or keep around a copy of the previous value and compute the delta the next time the window triggers.<sup><a data-type="noteref" id="idm140176513172864-marker" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513172864">14</a></sup> (This mode might have better been called Delta mode.)</p>
	</li>
	<li>
	<p><em>Accumulating mode</em> requires no additional work; <a contenteditable="false" data-primary="accumulating mode (accumulation)" data-type="indexterm" id="idm140176513170688"></a>the current value for the window in the table at triggering time is what is emitted. (This mode might have better been called Value mode.)</p>
	</li>
	<li>
	<p><em>Accumulating and retracting mode</em> requires keeping around copies of all previously triggered (but not yet retracted) values for the window.<a contenteditable="false" data-primary="accumulating and retracting mode" data-type="indexterm" id="idm140176513167952"></a> This list of previous values can grow quite large in the case of merging windows like sessions, but is vital to cleanly reverting the effects of those previous trigger firings in cases where the new value cannot simply be used to overwrite a previous value. (This mode might have better been called Value and Retractions mode.)</p>
	</li>
</ul>

<p>The streams-and-tables visualizations of accumulation modes add little additional insight into their semantics, so we won’t investigate them here.</p>
</div></section>

<section data-type="sect2" data-pdf-bookmark="A Holistic View of Streams and Tables in the Beam Model"><div class="sect2" id="idm140176513165248">
<h2>A Holistic View of Streams and Tables in the Beam Model</h2>

<p>Having addressed the four questions, we can now take a holistic view of streams and tables in a Beam Model<a contenteditable="false" data-primary="Beam Model" data-secondary="holistic view of streams and tables in" data-type="indexterm" id="ix_Beamstrtbl"></a> pipeline. <a contenteditable="false" data-primary="streams and tables" data-secondary="holistic view of in Beam Model" data-type="indexterm" id="ix_strmtblhol"></a>Let’s take our running example (the team scores calculation pipeline) and see what its structure looks like at the streams-and-table level. The full code for the pipeline might look something like <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#our_full_score_parsing_pipeline">Example&nbsp;6-6</a> (repeating <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#watermark_completeness_trigger_chap_six">Example&nbsp;6-4</a>).</p>

<div data-type="example" id="our_full_score_parsing_pipeline">
<h5><span class="label">Example 6-6. </span>Our full score-parsing pipeline</h5>

<pre data-type="programlisting">PCollection&lt;String&gt; raw = IO.read(...);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; input = raw.apply(<span class="what_lt">new ParseFn()</span>);
PCollection&lt;KV&lt;Team, Integer&gt;&gt; totals = input
  .apply(<span class="where_lt">Window.into(FixedWindows.of(TWO_MINUTES))</span>
               <span class="when_lt">.triggering(</span>
                 <span class="when_lt">AfterWatermark()</span>
                   <span class="when_lt">.withEarlyFirings(AlignedDelay(ONE_MINUTE))</span>
                   <span class="when_lt">.withLateFirings(AfterCount(1)))</span>)
  .apply(<span class="what_lt">Sum.integersPerKey()</span>);
</pre>
</div>

<p>Breaking that apart into stages separated by the intermediate <code>PCollection</code> types (where I’ve used more semantic “type” names like <code>Team</code> and <code>User Score</code> than real types for clarity of what is happening at each stage), you would arrive at something like that depicted in <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#logical_phases_of_a_team_score_summation_pipeline_with_intermediate">Figure&nbsp;6-13</a>.</p>

<figure class="smallertwentyfive"><div id="logical_phases_of_a_team_score_summation_pipeline_with_intermediate" class="figure"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0613.png" width="200" height="800" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0613.png">
<h6><span class="label">Figure 6-13. </span>Logical phases of a team score summation pipeline, with intermediate PCollection types</h6>
</div></figure>

<p>When you actually run this pipeline, it first goes through an optimizer, whose job is to convert this logical execution plan into an optimized, physical execution plan. Each execution engine is different, so actual physical execution plans will vary between runners. But a believable strawperson plan might look something like <a data-type="xref" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#theoretical_physical_phases_of_a_team_score_summation_pipeline_with_intermediate_pcollection_types">Figure&nbsp;6-14</a>.</p>

<figure><div id="theoretical_physical_phases_of_a_team_score_summation_pipeline_with_intermediate_pcollection_types" class="figure"><img src="https://www.safaribooksonline.com/library/view/streaming-systems/9781491983867/assets/stsy_0614.png" width="372" height="800" data-mfp-src="/library/view/streaming-systems/9781491983867/assets/stsy_0614.png">
<h6><span class="label">Figure 6-14. </span>Theoretical physical phases of a team score summation pipeline, with intermediate PCollection types</h6>
</div></figure>

<p>There’s a lot going on here, so let’s walk through all of it. There are three main differences between Figures <a data-type="xref" data-xrefstyle="select:labelnumber" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#logical_phases_of_a_team_score_summation_pipeline_with_intermediate">6-13</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#theoretical_physical_phases_of_a_team_score_summation_pipeline_with_intermediate_pcollection_types">6-14</a> that we’ll be discussing:</p>

<dl>
	<dt>Logical versus physical operations</dt>
	<dd>
	<p>As part of building a physical execution plan, <a contenteditable="false" data-primary="logical vs. physical operations in Beam Model" data-type="indexterm" id="idm140176513136496"></a>the underlying engine must convert the logical operations provided by the user into a sequence of primitive operations supported by the engine. In some cases, those physical equivalents look essentially the same (e.g., <code>Parse</code>), and in others, they’re very different.</p>
	</dd>
	<dt>Physical stages and fusion</dt>
	<dd>
	<p>It’s often inefficient to execute<a contenteditable="false" data-primary="physical stages and fusion in Beam Model" data-type="indexterm" id="idm140176513133184"></a> each logical phase as a fully independent physical stage in the pipeline (with attendant serialization, network communication, and deserialization overhead between each). As a result, the optimizer will typically try to fuse as many physical operations as possible into a single physical stage.</p>
	</dd>
	<dt>Keys, values, windows, and partitioning</dt>
	<dd>
	<p>To make it more evident what each physical operation is doing, I’ve annotated the intermediate <code>PCollection</code>s with the type of key, value, window, and data partitioning in effect at each point.<a contenteditable="false" data-primary="keys, values, windows and partitioning in Beam Model" data-type="indexterm" id="idm140176513129696"></a></p>
	</dd>
</dl>

<p>Let’s now walk through each logical operation in detail and see what it translated to in the physical plan and how they all relate<a contenteditable="false" data-primary="logical vs. physical operations in Beam Model" data-secondary="and how they relate to streams and tables" data-type="indexterm" id="idm140176513127808"></a> to streams and tables:</p>

<dl>
	<dt><code>ReadFromSource</code></dt>
	<dd>
	<p>Other than being fused with the physical operation immediately following it (<code>Parse</code>), not much interesting happens in translation for <code>ReadFromSource</code>. As far as the characteristics of our data at this point, because the read is essentially consuming raw input bytes, we basically have raw strings with no keys, no windows, and no (or random) partitioning. The original data source can be either a table (e.g., a Cassandra table) or a stream (e.g., RabbitMQ) or something a little like both (e.g., Kafka in log compaction mode). But regardless, the end result of reading from the input source is a stream.</p>
	</dd>
	<dt><code>Parse</code></dt>
	<dd>
	<p>The logical <code>Parse</code> operation also translates in a relatively straightforward manner to the physical version. <code>Parse</code> takes the raw strings and extracts a key (team ID) and value (user score) from them. It’s a nongrouping operation, and thus the stream it consumed remains a stream on the other side.</p>
	</dd>
	<dt><code>Window+Trigger</code></dt>
	<dd>
	<p>This logical operation is spread out across a number of distinct physical operations. The first is window assignment, in which each element is assigned to a set of windows. That happens immediately in the <code>AssignWindows</code> operation, which is a nongrouping operation that simply annotates each element in the stream with the window(s) it now belongs to, yielding another stream on the other side.</p>

	<p>The second is window merging, which we learned earlier in the chapter happens as part of the grouping operation. As such, it gets sunk down into the <code>GroupMergeAndCombine</code> operation later in the pipeline. We discuss that operation when we talk about the logical <code>Sum</code> operation next.</p>

	<p>And finally, there’s triggering. Triggering happens after grouping and is the way that we’ll convert the table created by grouping back into a stream. As such, it gets sunk into its own operation, which follows <code>GroupMergeAndCombine</code>.</p>
	</dd>
	<dt><code>Sum</code></dt>
	<dd>
	<p>Summation is really a composite operation, consisting of a couple pieces: partitioning and aggregation. Partitioning is a nongrouping operation that redirects the elements in the stream in such a way that elements with the same keys end up going to the same physical machine. Another word for partitioning is shuffling, though that term is a bit overloaded because “Shuffle” in the MapReduce sense is often used to mean both partitioning <em>and</em> grouping (<em>and</em> sorting, for that matter). Regardless, partitioning physically alters the stream in way that makes it groupable but doesn’t do anything to actually bring the data to rest. As a result, it’s a nongrouping operation that yields another stream on the other side.</p>

	<p>After partitioning comes grouping. Grouping itself is a composite operation. First comes grouping by key (enabled by the previous partition-by-key operation). Next comes window merging and grouping by window, as we described earlier. And finally, because summation is implemented as a <code>CombineFn</code> in Beam (essentially an incremental aggregation operation), there’s combining, where individual elements are summed together as they arrive. The specific details are not terribly important for our purposes here. What is important is the fact that, since this is (obviously) a grouping operation, our chain of streams now comes to rest in a table containing the summed team totals as they evolve over time.</p>
	</dd>
	<dt><code>WriteToSink</code></dt>
	<dd>
	<p>Lastly, we have the write operation, which takes the stream yielded by triggering (which was sunk below the <code>GroupMergeAndCombine</code> operation, as you might recall) and writes it out to our output data sink. That data itself can be either a table or stream. If it’s a table, <code>WriteToSink</code> will need to perform some sort of grouping operation as part of writing the data into the table. If it’s a stream, no grouping will be necessary (though partitioning might still be desired; for example, when writing into something like Kafka).</p>
	</dd>
</dl>

<p>The big takeaway here is not so much the precise details of everything that’s going on in the physical plan, <a contenteditable="false" data-primary="grouping operations" data-secondary="grouping/ungrouping in streams and tables" data-tertiary="in Beam Model processing" data-type="indexterm" id="idm140176513107056"></a>but more the overall relationship of the<a contenteditable="false" data-primary="Beam Model" data-secondary="relationship to streams and tables model" data-type="indexterm" id="idm140176513105216"></a> Beam Model to the world of streams and tables. We saw three types of operations: nongrouping (e.g., <code>Parse</code>), grouping (e.g., <code>GroupMergeAndCombine</code>), and ungrouping (e.g., <code>Trigger</code>). The nongrouping operations always consumed streams and produced streams on the other side. The grouping operations always consumed streams and yielded tables. And the ungrouping operations consumed tables and yielded streams. These insights, along with everything else we’ve learned along the way, are enough for us to formulate a more general theory about the relationship of the Beam Model to streams and tables.<a contenteditable="false" data-primary="Beam Model" data-secondary="holistic view of streams and tables in" data-startref="ix_Beamstrtbl" data-type="indexterm" id="idm140176513101792"></a><a contenteditable="false" data-primary="streams and tables" data-secondary="holistic view of in Beam Model" data-startref="ix_strmtblhol" data-type="indexterm" id="idm140176513100176"></a></p>
</div></section>
</div></section>

<section data-type="sect1" data-pdf-bookmark="A General Theory of Stream and Table Relativity"><div class="sect1" id="idm140176513164624">
<h1>A General Theory of Stream and Table Relativity</h1>

<p>Having surveyed how stream processing,<a contenteditable="false" data-primary="streams and tables" data-secondary="general theory of stream and table relativity" data-type="indexterm" id="ix_strmtblrel"></a> batch processing, the four <em><span class="what_lt">what</span></em>/<em><span class="where_lt">where</span></em>/<em><span class="when_lt">when</span></em>/<em><span class="how_lt">how</span></em> questions, and the Beam Model as a whole relate to stream and table theory, let’s now attempt to articulate a more general definition of stream and table relativity.</p>

<p><em>A general theory of stream and table relativity​</em>:</p>

<ul>
	<li>
	<p><em>Data processing pipelines</em> (both batch and streaming) consist of <em>tables</em>, <em>streams</em>, and <em>operations</em> upon those tables and streams.</p>
	</li>
	<li>
	<p><em>Tables</em> are <em>data at rest</em>, and act as a container for data to accumulate and be observed over time.</p>
	</li>
	<li>
	<p><em>Streams</em> are <em>data in motion</em>, and encode a discretized view of the evolution of a table over time.</p>
	</li>
	<li>
	<p><em>Operations</em> act upon a stream or table<a contenteditable="false" data-primary="nongrouping operations" data-type="indexterm" id="idm140176513083712"></a> and yield a new stream or table. They are categorized as follows:</p>

	<ul>
		<li>
		<p>stream → stream: Nongrouping (element-wise) operations</p>

		<p>Applying <em>nongrouping</em> operations to a stream alters the data in the stream while leaving them in motion, yielding a new stream with possibly different cardinality.</p>
		</li>
		<li>
		<p>stream → table: Grouping operations</p>

		<p><em>Grouping</em> data within a stream brings those data to rest, yielding a <em>table</em> that evolves over time.</p>

		<ul>
			<li>
			<p><em>Windowing</em> incorporates the dimension of event time into such groupings.</p>
			</li>
			<li>
			<p><em>Merging windows</em> dynamically combine over time, allowing them to reshape themselves in response to the data observed and dictating that key remain the unit of atomicity/parallelization, with window being a child component of grouping within that key.</p>
			</li>
		</ul>
		</li>
		<li>
		<p>table → stream: Ungrouping (triggering) operations</p>

		<p><em>Triggering</em> data within a table ungroups them into motion, yielding a <em>stream</em> that captures a view of the table’s evolution over time.</p>

		<ul>
			<li>
			<p><em>Watermarks</em> provide a notion of input completeness relative to event time, which is a useful reference point when triggering event-timestamped data, particularly data grouped into event-time windows from unbounded streams.</p>
			</li>
			<li>
			<p>The <em>accumulation mode</em> for the trigger determines the nature of the stream, dictating whether it contains deltas or values, and whether retractions for previous deltas/values are provided.</p>
			</li>
		</ul>
		</li>
		<li>
		<p>table → table: (none)</p>

		<p>There are no operations that consume a table and yield a table, because it’s not possible for data to go from rest and back to rest without being put into motion. As a result, all modifications to a table are via conversion to a stream and back again.</p>
		</li>
	</ul>
	</li>
</ul>

<p>What I love about these rules is that they just make sense. They have a very natural and intuitive feeling about them, and as a result they make it so much easier to understand how data flow (or don’t) through a sequence of operations. They codify the fact that data exist in one of two constitutions at any given time (streams or tables), and they provide simple rules for reasoning about the transitions between those states. They demystify windowing by showing how it’s just a slight modification of a thing everyone already innately understands: grouping. They highlight why grouping operations in general are always such a sticking point for streaming (because they bring data in streams to rest as tables) but also make it very clear what sorts of operations are needed to get things unstuck (triggers; i.e., ungrouping operations). And they underscore just how unified batch and stream processing really are, at a conceptual level.</p>

<p>When I set out to write this chapter, I wasn’t entirely sure what I was going to end up with, but the end result was much more satisfying than I’d imagined it might be. In the chapters to come, we use this theory of stream and table relativity again and again to help guide our analyses. And every time, its application will bring clarity and insight that would otherwise have been much harder to gain. Streams and tables are the best.<a contenteditable="false" data-primary="streams and tables" data-secondary="general theory of stream and table relativity" data-startref="ix_strmtblrel" data-type="indexterm" id="idm140176513064752"></a></p>
</div></section>

<section data-type="sect1" data-pdf-bookmark="Summary"><div class="sect1" id="idm140176513062880">
<h1>Summary</h1>

<p>In this chapter, we first established the basics of stream and table theory. We first defined streams and tables relatively:</p>

<dl>
	<dt>streams <span class="roman">→</span> tables</dt>
	<dd>
	<p>The aggregation of a stream of updates over time yields a table.</p>
	</dd>
	<dt>tables <span class="roman">→</span> streams</dt>
	<dd>
	<p>The observation of changes to a table over time yields a stream.</p>
	</dd>
</dl>

<p>We next defined them independently:</p>

<ul>
	<li>
	<p>Tables are data <em>at rest</em>.</p>
	</li>
	<li>
	<p>Streams are data <em>in motion</em>.</p>
	</li>
</ul>

<p>We then assessed the classic MapReduce model of batch computation from a streams and tables perspective and came to the conclusion that the following four steps describe batch processing from that perspective:</p>

<ol>
	<li>
	<p>Tables are read in their entirety to become streams.</p>
	</li>
	<li>
	<p>Streams are processed into new streams until a grouping operation is hit.</p>
	</li>
	<li>
	<p>Grouping turns the stream into a table.</p>
	</li>
	<li>
	<p>Steps 1 through 3 repeat until you run out of operations in the pipeline.</p>
	</li>
</ol>

<p>From this analysis, we were able to see that streams are just as much a part of batch processing as they are stream processing, and also that the idea of data being a stream is an orthogonal one from whether the data in question are bounded or unbounded.</p>

<p>Next, we spent a good deal of time considering the relationship between streams and tables and the robust, out-of-order stream processing semantics afforded by the Beam Model, ultimately arriving at the general theory of stream and table relativity we enumerated in the previous section. In addition to the basic definitions of streams and tables, the key insight in that theory is that there are four (really, just three) types of operations in a data<a contenteditable="false" data-primary="nongrouping operations" data-type="indexterm" id="idm140176513046688"></a> processing pipeline:</p>

<dl>
	<dt>stream <span class="roman">→</span> stream</dt>
	<dd>
	<p>Nongrouping (element-wise) operations</p>
	</dd>
	<dt>stream <span class="roman">→</span> table</dt>
	<dd>
	<p>Grouping operations</p>
	</dd>
	<dt>table <span class="roman">→</span> stream</dt>
	<dd>
	<p>Ungrouping (triggering) operations</p>
	</dd>
	<dt>table <span class="roman">→</span> table</dt>
	<dd>
	<p>(nonexistent)</p>
	</dd>
</dl>

<p>By classifying operations in this way, it becomes trivial to understand how data flow through (and linger within) a given pipeline over time.</p>

<p>Finally, and perhaps most important of all, we learned this: when you look at things from the streams-and-tables point of view, it becomes abundantly clear how batch and streaming really are just the same thing conceptually. Bounded or unbounded, it doesn’t matter.<a contenteditable="false" data-primary="streams and tables" data-secondary="and tables" data-startref="ix_strmtbl" data-type="indexterm" id="idm140176513035360"></a> It’s streams<a contenteditable="false" data-primary="tables and streams" data-startref="ix_tblstrm" data-type="indexterm" id="idm140176513033584"></a> and tables from top to bottom.</p>

<p>&lt;/bad-physics-jokes&gt;</p>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm140176513819744"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513819744-marker" class="totri-footnote">1</a></sup> If you didn’t go to college for computer science and you’ve made it this far in the book, you are likely either 1) my parents, 2) masochistic, or 3) very smart (and for the record, I’m not implying these groups are necessarily mutually exclusive; figure that one out if you can, Mom and Dad! &lt;winky-smiley/&gt;).</p><p data-type="footnote" id="idm140176513792784"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513792784-marker" class="totri-footnote">2</a></sup> And note that in some cases, the tables themselves can accept time as a query parameter, allowing you to peer backward in time to snapshots of the table as it existed in the past.</p><p data-type="footnote" id="idm140176513770512"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513770512-marker" class="totri-footnote">3</a></sup> Note that no guarantees are made about the keys of two successive records observed by a single mapper, because no key-grouping has occurred yet. The existence of the key here is really just to allow keyed datasets to be consumed in a natural way, and if there are no obvious keys for the input data, they’ll all just share what is effectively a global null key.</p><p data-type="footnote" id="idm140176513760720"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513760720-marker" class="totri-footnote">4</a></sup> Calling the inputs to a batch job “static” might be a bit strong. In reality, the dataset being consumed can be constantly changing as it’s processed; that is, if you’re reading directly from an HBase/Bigtable table within a timestamp range in which the data aren’t guaranteed to be immutable. But in most cases, the recommended approach is to ensure that you’re somehow processing a static snapshot of the input data, and any deviation from that assumption is at your own peril.</p><p data-type="footnote" id="idm140176513494944"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513494944-marker" class="totri-footnote">5</a></sup> Note that grouping a stream by key is importantly distinct from simply <em>partitioning</em> that stream by key, which ensures that all records with the same key end up being processed by the same machine but doesn’t do anything to put the records to rest. They instead remain in motion and thus continue on as a stream. A grouping operation is more like a partition-by-key followed by a write to the appropriate group for that partition, which is what puts them to rest and turns the stream into a table.</p><p data-type="footnote" id="idm140176513482816"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513482816-marker" class="totri-footnote">6</a></sup> One giant difference, from an implementation perspective at least, being that ReduceWrite, knowing that keys have already been grouped together by MapWrite, and further knowing that Reduce is unable to alter keys for the case in which its outputs remain keyed, can simply accumulate the outputs generated by reducing the values for a single key in order to group them together, which is much simpler than the full-blown shuffle implementation required for a MapWrite phase.</p><p data-type="footnote" id="idm140176513479936"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513479936-marker" class="totri-footnote">7</a></sup> Another way of looking at it is that there are two types of tables: updateable and appendable; this is the way the Flink folks have framed it for their Table API. But even though that’s a great intuitive way of capturing the observed semantics of the two situations, I think it obscures the underlying nature of what’s actually happening that causes a stream to come to rest as a table; that is, grouping.</p><p data-type="footnote" id="idm140176513364064"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513364064-marker" class="totri-footnote">8</a></sup> Though as we can clearly see from this example, it’s not just a streaming thing; you can get the same effect with a batch system if its state tables are world readable.</p><p data-type="footnote" id="idm140176513362432"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513362432-marker" class="totri-footnote">9</a></sup> This is particularly painful if a sink for your storage system of choice doesn’t exist yet; building proper sinks that can uphold consistency guarantees is a surprisingly subtle and difficult task.</p><p data-type="footnote" id="idm140176513340240"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513340240-marker">10</a></sup> This also means that if you place a value into multiple windows—for example, sliding windows—the value must conceptually be duplicated into multiple, independent records, one per window. Even so, it’s possible in some cases for the underlying system to be smart about how it treats certain types of overlapping windows, thus optimize away the need for actually duplicating the value. Spark, for example, does this for sliding windows.</p><p data-type="footnote" id="idm140176513214496"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513214496-marker">11</a></sup> Note that this high-level conceptual view of how things work in batch pipelines belies the complexity of efficiently triggering an entire table of data at once, particularly when that table is sizeable enough to require a plurality of machines to process. The <a href="https://s.apache.org/splittable-do-fn">SplittableDoFn API</a> recently added to Beam provides some insight into the mechanics involved.</p><p data-type="footnote" id="idm140176513189696"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513189696-marker">12</a></sup> And yes, if you blend batch and streaming together you get Beam, which is where that name came from originally. For reals.</p><p data-type="footnote" id="idm140176513179920"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513179920-marker">13</a></sup> This is why you should always use an Oxford comma.</p><p data-type="footnote" id="idm140176513172864"><sup><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#idm140176513172864-marker">14</a></sup> Note that in the case of merging windows, in addition to merging the current values for the two windows to yield a merged current value, the previous values for those two windows would need to be merged, as well, to allow for the later calculation of a merged delta come triggering time.</p></div></div></section><div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-0" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders ">
		
		<li class="copy"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#">Copy</a></li>
		
		<li class="add-highlight"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#">Add Highlight</a></li>
		<li class="add-note"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#">
			
				Add Note
			
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/part02.html" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">II. Streams and Tables</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch07.html" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">7. The Practicalities of Persistent State</div>
        </a>
    
  
  </div>


        
    </section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    
      <div id="js-subscribe-nag" class="subscribe-nag clearfix trial-panel t-subscribe-nag collapsed slideUp">
        
        
          
          
            <p class="usage-data">Find answers on the fly, or master something new. Subscribe today. <a href="https://www.safaribooksonline.com/subscribe/" class="ga-active-trial-subscribe-nag">See pricing options.</a></p>
          

          
        
        

      </div>

    
    



        
      </div>
      




  <footer class="pagefoot t-pagefoot" style="padding-bottom: 69px;">
    <a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" class="icon-up"><div class="visuallyhidden">Back to top</div></a>
    <ul class="js-footer-nav">
      
        <li><a class="t-recommendations-footer" href="https://www.safaribooksonline.com/r/">Recommended</a></li>
      
      <li>
      <a class="t-queue-footer" href="https://www.safaribooksonline.com/playlists/">Playlists</a>
      </li>
      
        <li><a class="t-recent-footer" href="https://www.safaribooksonline.com/history/">History</a></li>
        <li><a class="t-topics-footer" href="https://www.safaribooksonline.com/topics?q=*&amp;limit=21">Topics</a></li>
      
      
        <li><a class="t-tutorials-footer" href="https://www.safaribooksonline.com/tutorials/">Tutorials</a></li>
      
      <li><a class="t-settings-footer js-settings" href="https://www.safaribooksonline.com/u/preferences/">Settings</a></li>
      <li class="full-support"><a href="https://www.oreilly.com/online-learning/support/">Support</a></li>
      <li><a href="https://www.safaribooksonline.com/apps/">Get the App</a></li>
      <li><a href="https://www.safaribooksonline.com/accounts/logout/">Sign Out</a></li>
    </ul>
    <span class="copyright">© 2018 <a href="https://www.safaribooksonline.com/" target="_blank">Safari</a>.</span>
    <a href="https://www.safaribooksonline.com/terms/">Terms of Service</a> /
    <a href="https://www.safaribooksonline.com/privacy/">Privacy Policy</a>
  </footer>




    
    
      <img src="https://www.oreilly.com/library/view/oreilly_set_cookie/" alt="" style="display:none;">
    
    
    
  

<div class="annotator-notice"></div><div class="font-flyout" style="top: 151.01px; left: 1356px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="/safari-books-archive/site/library/view/streaming-systems/9781491983867/ch06.html#">Reset</a>
</div>
</div>
<div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.2631033354746426"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.7977454658400345" width="0" height="0" alt="" src="https://bat.bing.com/action/0?ti=5794699&amp;Ver=2&amp;mid=81cd699d-3c71-5587-c423-0ee86ac575ca&amp;pi=1200101525&amp;lg=en-US&amp;sw=1440&amp;sh=900&amp;sc=24&amp;tl=6.%20Streams%20and%20Tables%20-%20Streaming%20Systems&amp;p=https%3A%2F%2Fwww.safaribooksonline.com%2Flibrary%2Fview%2Fstreaming-systems%2F9781491983867%2Fch06.html&amp;r=&amp;lt=10070&amp;evt=pageLoad&amp;msclkid=N&amp;rn=165020"></div></body></html>